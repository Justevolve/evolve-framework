"use strict";if(function(e){function t(e){return/string|number|boolean/.test(typeof e)}e.evExtendObject=function(i,n){if(t(i))return i;var s=i;return e.each(n,function(i,o){void 0===s[i]?t(n[i])?s[i]=o:s[i]={}:t(s[i])&&(s[i]=e.evExtendObject(s[i],n[i]))}),s},e.evSaveRichTextareas=function(t){"undefined"!=typeof tinymce&&e(".ev-rich",t).each(function(){tinymce.get(this.id).save()})},e.fn.serializeObject=function(){var t=this,i={},n={},s={validate:/^[a-zA-Z_][a-zA-Z0-9_]*(?:\[(?:\d*|[a-zA-Z0-9_]+)\])*$/,key:/[a-zA-Z0-9_]+|(?=\[\])/g,push:/^$/,fixed:/^\d+$/,named:/^[a-zA-Z0-9_]+$/};return this.build=function(e,t,i){return e[t]=i,e},this.push_counter=function(e){return void 0===n[e]&&(n[e]=0),n[e]++},e.each(e(this).serializeArray(),function(){if(s.validate.test(this.name)){for(var n,o=this.name.match(s.key),a=this.value,r=this.name;void 0!==(n=o.pop());)r=r.replace(new RegExp("\\["+n+"\\]$"),""),n.match(s.push)?a=t.build([],t.push_counter(r),a):n.match(s.fixed)?a=t.build([],n,a):n.match(s.named)&&(a=t.build({},n,a));i=e.extend(!0,i,a)}}),e.each(i,function(e,t){i[e].push&&(i[e]=i[e].filter(function(e){return void 0!==e&&null!==e&&~e}))}),i}}(jQuery),function(e){"function"!=typeof e.deparam&&(e.deparam=function(t,i){var n={},s={true:!0,false:!1,null:null};return e.each(t.replace(/\+/g," ").split("&"),function(t,o){var a,r=o.split("="),l=decodeURIComponent(r[0]),c=n,d=0,p=l.split("]["),u=p.length-1;if(/\[/.test(p[0])&&/\]$/.test(p[u])?(p[u]=p[u].replace(/\]$/,""),u=(p=p.shift().split("[").concat(p)).length-1):u=0,2===r.length)if(a=decodeURIComponent(r[1]),i&&(a=a&&!isNaN(a)?+a:"undefined"===a?void 0:void 0!==s[a]?s[a]:a),u)for(;d<=u;d++)c=c[l=""===p[d]?c.length:p[d]]=d<u?c[l]||(p[d+1]&&isNaN(p[d+1])?{}:[]):a;else e.isArray(n[l])?n[l].push(a):void 0!==n[l]?n[l]=[n[l],a]:n[l]=a;else l&&(n[l]=i?void 0:"")}),n})}(jQuery),"function"!=typeof String.prototype.replaceLast&&(String.prototype.replaceLast=function(e,t){var i=this.lastIndexOf(e);return i>=0?this.substring(0,i)+t+this.substring(i+e.length):this.toString()}),"undefined"==typeof jQuery)throw new Error("jQuery is required.");!function(e){e.evf={componentID:".ev-component",namespace:".evf",ui:{event:"ui-build",signature:"ev-ui",components:[],components_count:0,components_built:0,add:function(t,i){e.evf.ui.components.push({selector:t,callback:i}),e.evf.ui.components_count++},do_build:function(){e.each(e.evf.ui.components,function(){e.evf.ui.components_built++;var t=this.selector,i=this.callback,n=e(t);(n=n.filter(function(){return"1"!==e(this).attr("data-"+e.evf.ui.signature)})).length?(n.attr("data-"+e.evf.ui.signature,"1"),i.call(n),e.evf.ui.end_build()):e.evf.ui.end_build()})},end_build:function(){e.evf.ui.components_count===e.evf.ui.components_built&&setTimeout(function(){e(".ev-tab-container").addClass("ev-tab-container-loaded")},5)},build:function(){e.evf.ui.components_built=0,e.evf.ui.do_build(),e(window).trigger(e.evf.resolveEventName(e.evf.ui.event,e.evf.namespace))}},resolveNamespace:function(t){return""!==t&&-1===t.indexOf(".")&&(t="."+t),e.evf.namespace+t},resolveEventName:function(t,i){var n="";return e.each(t.split(" "),function(){n+=" "+this+e.evf.resolveNamespace(i)}),n=n.trim()},on:function(t,i,n,s){e(t).on(e.evf.resolveEventName(i,n),s)},one:function(t,i,n,s){e(t).one(e.evf.resolveEventName(i,n),s)},delegate:function(t,i,n,s){e(document).on(e.evf.resolveEventName(i,n),t,s)},undelegate:function(t,i){e(document).off(e.evf.resolveEventName(t,i))},template:function(t,i){if("undefined"==typeof _)throw new Error("Underscore is required.");var n=t;if("string"==typeof t&&(n=e("script[type='text/template'][data-template='"+t+"']")),!n.length)throw new Error("Template '"+t+"' not found.");var s={evaluate:/<#([\s\S]+?)#>/g,interpolate:/\{\{\{([\s\S]+?)\}\}\}/g,escape:/\{\{([^\}]+?)\}\}(?!\})/g};if(parseFloat(ev_framework.wp_version)<4.5)return _.template(n.html(),i,s);return _.template(n.html(),s)(i)}},e(document).on("ready",function(){e.evf.ui.build(),e.evf.tabs(".ev-tabs"+e.evf.componentID),e.evf.accordion(".ev-accordion"+e.evf.componentID)})}(jQuery),function(e){e.evf.key=function(t,i,n){if("function"!=typeof i)throw new Error("Callback is not a function.");var s={enter:13,left:37,up:38,right:39,down:40,esc:27,space:32,backspace:8,tab:9},o="ev";(n=e.extend({stop:!0,namespace:"ev",one:!1},n)).namespace&&(o="."+n.namespace);var a=function(e){if(s[t]&&e.which===s[t]){var o=i(e);if(void 0!==o)return o;if(n.stop)return!1}return!0};n.one?e(window).one("keydown."+o,a):e(window).on("keydown."+o,a)}}(jQuery),function(e){e.evf.tabs=function(t,i){i=e.extend({namespace:"tabs",navClass:".ev-tabs-nav",triggersClass:".ev-tab-trigger",panelsContainerClass:".ev-tab-container",tabsClass:".ev-tab",activeClass:"ev-active",eventTrigger:"click"},i);function n(n,s){var o=null,a=e(s);if(e(i.triggersClass+"[id='"+a[0].id+"']").length>1&&0==a.parents(".ev-tabs").length)return e(i.triggersClass).removeClass(i.activeClass).removeAttr("aria-selected"),e(i.triggersClass+"[id='"+a[0].id+"']").not(a).trigger(i.eventTrigger+"."+i.namespace),a.addClass(i.activeClass).attr("aria-selected","true"),!1;"object"==typeof t?o=e(n):"string"==typeof t&&(o=a.parents(n).first());var r=e("> "+i.navClass,o),l=e(i.triggersClass,r),c=e("> "+i.panelsContainerClass,o),d=e("> "+i.tabsClass,c),p=0;switch(l.each(function(e,t){this===s&&(p=e)}),o.data("push")){case"hash":e.evf.history.pushHash(a);break;case"querystring":e.evf.history.pushQueryString(a,"tab")}return o.trigger(e.evf.resolveEventName("switch",i.namespace)),l.removeClass(i.activeClass).removeAttr("aria-selected"),d.removeClass(i.activeClass).attr("aria-hidden","true"),a.addClass(i.activeClass).attr("aria-selected","true"),d.eq(p).addClass(i.activeClass).removeAttr("aria-hidden"),o.trigger(e.evf.resolveEventName("switched",i.namespace)),!1}if("object"==typeof t?e.evf.on(i.triggersClass,i.eventTrigger,i.namespace,function(){return n(t,this)}):"string"==typeof t&&e.evf.delegate(i.triggersClass,i.eventTrigger,i.namespace,function(){return n(t,this)}),""!=window.location.hash){var s=i.triggersClass+"[href='"+window.location.hash+"']";s+=","+i.triggersClass+"[data-target='"+window.location.hash+"']",e(s).trigger(e.evf.resolveEventName(i.eventTrigger,i.namespace))}}}(jQuery),function(e){e.evf.accordion=function(t,i){i=e.extend({namespace:"accordion",accordionClass:".ev-accordion",toggleClass:".ev-toggle",triggersClass:".ev-toggle-trigger",contentClass:".ev-toggle-content",activeClass:"ev-active",eventTrigger:"click focus",mode:!1},i);function n(n,s){var o=null,a=e(s);"object"==typeof t?o=e(n):"string"==typeof t&&(o=a.parents(n).first());var r=!1!==i.mode?i.mode:o.attr("data-mode"),l=e(i.triggersClass,o),c=e(i.toggleClass,o),d=0;switch(l.each(function(e,t){this===s&&(d=e)}),o.data("push")){case"hash":e.evf.history.pushHash(a);break;case"querystring":e.evf.history.pushQueryString(a,"toggle")}return o.trigger(e.evf.resolveEventName("switch",i.namespace)),"toggle"!==r?"true"==a.attr("aria-selected")?(a.removeAttr("aria-selected"),c.eq(d).removeClass(i.activeClass).attr("aria-hidden","true")):(l.removeAttr("aria-selected"),a.attr("aria-selected","true"),c.removeClass(i.activeClass).attr("aria-hidden","true"),c.eq(d).addClass(i.activeClass).removeAttr("aria-hidden")):"true"==a.attr("aria-selected")?(a.removeAttr("aria-selected"),c.eq(d).removeClass(i.activeClass).attr("aria-hidden","true")):(a.attr("aria-selected","true"),c.eq(d).addClass(i.activeClass).removeAttr("aria-hidden")),o.trigger(e.evf.resolveEventName("switched",i.namespace)),!1}if("object"==typeof t?e.evf.on(i.triggersClass,i.eventTrigger,i.namespace,function(){return n(t,this)}):"string"==typeof t&&e.evf.delegate(i.triggersClass,i.eventTrigger,i.namespace,function(){return n(t,this)}),""!=window.location.hash){var s=i.triggersClass+"[href='"+window.location.hash+"']";s+=","+i.triggersClass+"[data-target='"+window.location.hash+"']",e(s).trigger(e.evf.resolveEventName(i.eventTrigger,i.namespace))}}}(jQuery),function(e){e.evf.delegate(".ev-modal-close","click","modal",function(t){return e(this).parents(".ev-modal-container").first().data("ev-modal").close(),!1}),e.evf.key("esc",function(){var t=e(".ev-modal-container");if(t.length)return t.last().data("ev-modal").close(),!1}),e.evf.modal=function(t,i,n){n=e.extend({save:function(){},close:function(){},class:"",wait:!1,simple:!1},n);var s=this;s.config=n,this.close=function(){n.close(),e(".ev-modal-container[data-key='"+t+"']").nextAll(".ev-modal-container").remove(),e(".ev-modal-container[data-key='"+t+"']").remove();e(".ev-modal-container").length||e("body").removeClass("ev-modal-open"),e(window).trigger("ev-modal-close")},this.save=function(i){var s=e(".ev-modal-container[data-key='"+t+"']"+" .ev-modal-footer .ev-save").attr("data-nonce");n.wait?n.save(i,this.close,s):(n.save(i,null,s),this.close())},this.open=function(o){if("function"!=typeof o)throw new Error("Content is not a function.");var a=".ev-modal-container[data-key='"+t+"']";e(a).remove();var r=n.class;n.simple&&(r+=" ev-modal-container-simple");var l='<div class="ev-modal-container '+r+'" data-key="'+t+'">';l+='<div class="ev-modal-wrapper">',l+='<a class="ev-modal-close" href="#"><i data-icon="ev-modal-close" class="ev-icon ev-component" aria-hidden="true"></i></a>',l+='<div class="ev-modal-wrapper-inner">',l+="</div>",l+="</div>",l=e(l+="</div>"),e("body").hasClass("ev-modal-open")?e(".ev-modal-container").last().after(l):(l.appendTo(e("#ev-modals-container")),e("body").addClass("ev-modal-open")),e(".ev-modal-container").last().data("ev-modal",s),o(e(a+" .ev-modal-wrapper-inner"),t,i)},this.init=function(){var i=".ev-modal-container[data-key='"+t+"']",n=i+" .ev-modal-footer .ev-save",o=i+" form",a="modal-form-"+t;e.evf.undelegate("submit",a),e.evf.undelegate("click",a),e.evf.delegate(n,"click",a,function(){return e(o).trigger("submit."+a),!1}),e.evf.delegate(o,"submit",a,function(){return e.evSaveRichTextareas(this),ev_idle_button(e(n)),s.save(e(this).serializeObject()),e.evf.undelegate("submit",a),e.evf.undelegate("click",a),!1})},this.init()}}(jQuery),function(e){"function"==typeof define&&define.amd?define(["jquery"],e):"object"==typeof exports?module.exports=e(require("jquery")):e(jQuery)}(function(e){function t(e){var t=e.parent();e.removeData("minicolors-initialized").removeData("minicolors-settings").removeProp("size").removeClass("minicolors-input"),t.before(e).remove()}function i(e){var t=e.parent(),i=t.find(".minicolors-panel"),s=e.data("minicolors-settings");!e.data("minicolors-initialized")||e.prop("disabled")||t.hasClass("minicolors-inline")||t.hasClass("minicolors-focus")||(n(),t.addClass("minicolors-focus"),i.stop(!0,!0).fadeIn(s.showSpeed,function(){s.show&&s.show.call(e.get(0))}))}function n(){e(".minicolors-focus").each(function(){var t=e(this),i=t.find(".minicolors-input"),n=t.find(".minicolors-panel"),s=i.data("minicolors-settings");n.fadeOut(s.hideSpeed,function(){s.hide&&s.hide.call(i.get(0)),t.removeClass("minicolors-focus")})})}function s(e,t,i){var n,s,a,r,l=e.parents(".minicolors").find(".minicolors-input"),c=l.data("minicolors-settings"),d=e.find("[class$=-picker]"),p=e.offset().left,u=e.offset().top,h=Math.round(t.pageX-p),v=Math.round(t.pageY-u),f=i?c.animationSpeed:0;t.originalEvent.changedTouches&&(h=t.originalEvent.changedTouches[0].pageX-p,v=t.originalEvent.changedTouches[0].pageY-u),0>h&&(h=0),0>v&&(v=0),h>e.width()&&(h=e.width()),v>e.height()&&(v=e.height()),e.parent().is(".minicolors-slider-wheel")&&d.parent().is(".minicolors-grid")&&(n=75-h,s=75-v,a=Math.sqrt(n*n+s*s),r=Math.atan2(s,n),0>r&&(r+=2*Math.PI),a>75&&(a=75,h=75-75*Math.cos(r),v=75-75*Math.sin(r)),h=Math.round(h),v=Math.round(v)),e.is(".minicolors-grid")?d.stop(!0).animate({top:v+"px",left:h+"px"},f,c.animationEasing,function(){o(l,e)}):d.stop(!0).animate({top:v+"px"},f,c.animationEasing,function(){o(l,e)})}function o(e,t){function i(e,t){var i,n;return e.length&&t?(i=e.offset().left,n=e.offset().top,{x:i-t.offset().left+e.outerWidth()/2,y:n-t.offset().top+e.outerHeight()/2}):null}var n,s,o,r,c,d,p,u=e.val(),v=e.attr("data-opacity"),f=e.parent(),g=e.data("minicolors-settings"),m=f.find(".minicolors-input-swatch"),y=f.find(".minicolors-grid"),b=f.find(".minicolors-slider"),C=f.find(".minicolors-opacity-slider"),_=y.find("[class$=-picker]"),x=b.find("[class$=-picker]"),k=C.find("[class$=-picker]"),O=i(_,y),$=i(x,b),S=i(k,C);if(t.is(".minicolors-grid, .minicolors-slider, .minicolors-opacity-slider")){switch(g.control){case"wheel":r=y.width()/2-O.x,c=y.height()/2-O.y,d=Math.sqrt(r*r+c*c),0>(p=Math.atan2(c,r))&&(p+=2*Math.PI),d>75&&(d=75,O.x=69-75*Math.cos(p),O.y=69-75*Math.sin(p)),s=h(d/.75,0,100),u=w({h:n=h(180*p/Math.PI,0,360),s:s,b:o=h(100-Math.floor($.y*(100/b.height())),0,100)}),b.css("backgroundColor",w({h:n,s:s,b:100}));break;case"saturation":u=w({h:n=h(parseInt(O.x*(360/y.width()),10),0,360),s:s=h(100-Math.floor($.y*(100/b.height())),0,100),b:o=h(100-Math.floor(O.y*(100/y.height())),0,100)}),b.css("backgroundColor",w({h:n,s:100,b:o})),f.find(".minicolors-grid-inner").css("opacity",s/100);break;case"brightness":u=w({h:n=h(parseInt(O.x*(360/y.width()),10),0,360),s:s=h(100-Math.floor(O.y*(100/y.height())),0,100),b:o=h(100-Math.floor($.y*(100/b.height())),0,100)}),b.css("backgroundColor",w({h:n,s:s,b:100})),f.find(".minicolors-grid-inner").css("opacity",1-o/100);break;default:u=w({h:n=h(360-parseInt($.y*(360/b.height()),10),0,360),s:s=h(Math.floor(O.x*(100/y.width())),0,100),b:o=h(100-Math.floor(O.y*(100/y.height())),0,100)}),y.css("backgroundColor",w({h:n,s:100,b:100}))}a(e,u,v=g.opacity?parseFloat(1-S.y/C.height()).toFixed(2):1)}else m.find("span").css({backgroundColor:u,opacity:v}),l(e,u,v)}function a(e,t,i){var n,s=e.parent(),o=e.data("minicolors-settings"),a=s.find(".minicolors-input-swatch");o.opacity&&e.attr("data-opacity",i),"rgb"===o.format?(n=v(t)?p(t,!0):y(d(t,!0)),i=""===e.attr("data-opacity")?1:h(parseFloat(e.attr("data-opacity")).toFixed(2),0,1),(isNaN(i)||!o.opacity)&&(i=1),t=e.minicolors("rgbObject").a<=1&&n&&o.opacity?"rgba("+n.r+", "+n.g+", "+n.b+", "+parseFloat(i)+")":"rgb("+n.r+", "+n.g+", "+n.b+")"):(v(t)&&(t=g(t)),t=c(t,o.letterCase)),e.val(t),a.find("span").css({backgroundColor:t,opacity:i}),l(e,t,i)}function r(t,i){var n,s,o,a,r,m,b,C,_,x,k=t.parent(),O=t.data("minicolors-settings"),$=k.find(".minicolors-input-swatch"),S=k.find(".minicolors-grid"),I=k.find(".minicolors-slider"),T=k.find(".minicolors-opacity-slider"),j=S.find("[class$=-picker]"),z=I.find("[class$=-picker]"),F=T.find("[class$=-picker]");switch(v(t.val())?(n=g(t.val()),(r=h(parseFloat(f(t.val())).toFixed(2),0,1))&&t.attr("data-opacity",r)):n=c(d(t.val(),!0),O.letterCase),n||(n=c(u(O.defaultValue,!0),O.letterCase)),s=function(e){var t=function(e){var t={h:0,s:0,b:0},i=Math.min(e.r,e.g,e.b),n=Math.max(e.r,e.g,e.b),s=n-i;return t.b=n,t.s=0!==n?255*s/n:0,0!==t.s?e.r===n?t.h=(e.g-e.b)/s:e.g===n?t.h=2+(e.b-e.r)/s:t.h=4+(e.r-e.g)/s:t.h=-1,t.h*=60,t.h<0&&(t.h+=360),t.s*=100/255,t.b*=100/255,t}(y(e));return 0===t.s&&(t.h=360),t}(n),a=O.keywords?e.map(O.keywords.split(","),function(t){return e.trim(t.toLowerCase())}):[],m=""!==t.val()&&e.inArray(t.val().toLowerCase(),a)>-1?c(t.val()):v(t.val())?p(t.val()):n,i||t.val(m),O.opacity&&(o=""===t.attr("data-opacity")?1:h(parseFloat(t.attr("data-opacity")).toFixed(2),0,1),isNaN(o)&&(o=1),t.attr("data-opacity",o),$.find("span").css("opacity",o),C=h(T.height()-T.height()*o,0,T.height()),F.css("top",C+"px")),"transparent"===t.val().toLowerCase()&&$.find("span").css("opacity",0),$.find("span").css("backgroundColor",n),O.control){case"wheel":_=h(Math.ceil(.75*s.s),0,S.height()/2),x=s.h*Math.PI/180,b=h(75-Math.cos(x)*_,0,S.width()),C=h(75-Math.sin(x)*_,0,S.height()),j.css({top:C+"px",left:b+"px"}),C=150-s.b/(100/S.height()),""===n&&(C=0),z.css("top",C+"px"),I.css("backgroundColor",w({h:s.h,s:s.s,b:100}));break;case"saturation":b=h(5*s.h/12,0,150),C=h(S.height()-Math.ceil(s.b/(100/S.height())),0,S.height()),j.css({top:C+"px",left:b+"px"}),C=h(I.height()-s.s*(I.height()/100),0,I.height()),z.css("top",C+"px"),I.css("backgroundColor",w({h:s.h,s:100,b:s.b})),k.find(".minicolors-grid-inner").css("opacity",s.s/100);break;case"brightness":b=h(5*s.h/12,0,150),C=h(S.height()-Math.ceil(s.s/(100/S.height())),0,S.height()),j.css({top:C+"px",left:b+"px"}),C=h(I.height()-s.b*(I.height()/100),0,I.height()),z.css("top",C+"px"),I.css("backgroundColor",w({h:s.h,s:s.s,b:100})),k.find(".minicolors-grid-inner").css("opacity",1-s.b/100);break;default:b=h(Math.ceil(s.s/(100/S.width())),0,S.width()),C=h(S.height()-Math.ceil(s.b/(100/S.height())),0,S.height()),j.css({top:C+"px",left:b+"px"}),C=h(I.height()-s.h/(360/I.height()),0,I.height()),z.css("top",C+"px"),S.css("backgroundColor",w({h:s.h,s:100,b:100}))}t.data("minicolors-initialized")&&l(t,m,o)}function l(e,t,i){var n,s,o=e.data("minicolors-settings"),a=e.data("minicolors-lastChange");if(!a||a.value!==t||a.opacity!==i){if(e.data("minicolors-lastChange",{value:t,opacity:i}),o.swatches&&0!==o.swatches.length){for(n=v(t)?p(t,!0):y(t),-1,s=0;s<o.swatches.length;++s)if(n.r===o.swatches[s].r&&n.g===o.swatches[s].g&&n.b===o.swatches[s].b&&n.a===o.swatches[s].a){s;break}e.parent().find(".minicolors-swatches .minicolors-swatch").removeClass("selected"),-1!==s&&e.parent().find(".minicolors-swatches .minicolors-swatch").eq(s).addClass("selected")}o.change&&(o.changeDelay?(clearTimeout(e.data("minicolors-changeTimeout")),e.data("minicolors-changeTimeout",setTimeout(function(){o.change.call(e.get(0),t,i)},o.changeDelay))):o.change.call(e.get(0),t,i)),e.trigger("change").trigger("input")}}function c(e,t){return"uppercase"===t?e.toUpperCase():e.toLowerCase()}function d(e,t){return(e=e.replace(/^#/g,"")).match(/^[A-F0-9]{3,6}/gi)?3!==e.length&&6!==e.length?"":(3===e.length&&t&&(e=e[0]+e[0]+e[1]+e[1]+e[2]+e[2]),"#"+e):""}function p(e,t){var i=e.replace(/[^\d,.]/g,"").split(",");return i[0]=h(parseInt(i[0],10),0,255),i[1]=h(parseInt(i[1],10),0,255),i[2]=h(parseInt(i[2],10),0,255),i[3]&&(i[3]=h(parseFloat(i[3],10),0,1)),t?{r:i[0],g:i[1],b:i[2],a:i[3]?i[3]:null}:void 0!==i[3]&&i[3]<=1?"rgba("+i[0]+", "+i[1]+", "+i[2]+", "+i[3]+")":"rgb("+i[0]+", "+i[1]+", "+i[2]+")"}function u(e,t){return v(e)?p(e):d(e,t)}function h(e,t,i){return t>e&&(e=t),e>i&&(e=i),e}function v(e){var t=e.match(/^rgba?[\s+]?\([\s+]?(\d+)[\s+]?,[\s+]?(\d+)[\s+]?,[\s+]?(\d+)[\s+]?/i);return!(!t||4!==t.length)}function f(e){return(e=e.match(/^rgba?[\s+]?\([\s+]?(\d+)[\s+]?,[\s+]?(\d+)[\s+]?,[\s+]?(\d+)[\s+]?,[\s+]?(\d+(\.\d{1,2})?|\.\d{1,2})[\s+]?/i))&&6===e.length?e[4]:"1"}function g(e){return(e=e.match(/^rgba?[\s+]?\([\s+]?(\d+)[\s+]?,[\s+]?(\d+)[\s+]?,[\s+]?(\d+)[\s+]?/i))&&4===e.length?"#"+("0"+parseInt(e[1],10).toString(16)).slice(-2)+("0"+parseInt(e[2],10).toString(16)).slice(-2)+("0"+parseInt(e[3],10).toString(16)).slice(-2):""}function m(t){var i=[t.r.toString(16),t.g.toString(16),t.b.toString(16)];return e.each(i,function(e,t){1===t.length&&(i[e]="0"+t)}),"#"+i.join("")}function w(e){return m(function(e){var t={},i=Math.round(e.h),n=Math.round(255*e.s/100),s=Math.round(255*e.b/100);if(0===n)t.r=t.g=t.b=s;else{var o=s,a=(255-n)*s/255,r=i%60*(o-a)/60;360===i&&(i=0),60>i?(t.r=o,t.b=a,t.g=a+r):120>i?(t.g=o,t.b=a,t.r=o-r):180>i?(t.g=o,t.r=a,t.b=a+r):240>i?(t.b=o,t.r=a,t.g=o-r):300>i?(t.b=o,t.g=a,t.r=a+r):360>i?(t.r=o,t.g=a,t.b=o-r):(t.r=0,t.g=0,t.b=0)}return{r:Math.round(t.r),g:Math.round(t.g),b:Math.round(t.b)}}(e))}function y(e){return{r:(e=parseInt(e.indexOf("#")>-1?e.substring(1):e,16))>>16,g:(65280&e)>>8,b:255&e}}e.minicolors={defaults:{animationSpeed:50,animationEasing:"swing",change:null,changeDelay:0,control:"hue",dataUris:!0,defaultValue:"",format:"hex",hide:null,hideSpeed:100,inline:!1,keywords:"",letterCase:"lowercase",opacity:!1,position:"bottom left",show:null,showSpeed:100,theme:"default",swatches:[]}},e.extend(e.fn,{minicolors:function(s,o){switch(s){case"destroy":return e(this).each(function(){t(e(this))}),e(this);case"hide":return n(),e(this);case"opacity":return void 0===o?e(this).attr("data-opacity"):(e(this).each(function(){r(e(this).attr("data-opacity",o))}),e(this));case"rgbObject":return function(t){var i=y(d(e(t).val(),!0)),n=e(t).attr("data-opacity");return i?(void 0!==n&&e.extend(i,{a:parseFloat(n)}),i):null}(e(this));case"rgbString":case"rgbaString":return function(t,i){var n=y(d(e(t).val(),!0)),s=e(t).attr("data-opacity");return n?(void 0===s&&(s=1),i?"rgba("+n.r+", "+n.g+", "+n.b+", "+parseFloat(s)+")":"rgb("+n.r+", "+n.g+", "+n.b+")"):null}(e(this),"rgbaString"===s);case"settings":return void 0===o?e(this).data("minicolors-settings"):(e(this).each(function(){var i=e(this).data("minicolors-settings")||{};t(e(this)),e(this).minicolors(e.extend(!0,i,o))}),e(this));case"show":return i(e(this).eq(0)),e(this);case"value":return void 0===o?e(this).val():(e(this).each(function(){"object"==typeof o&&null!==typeof o?(o.opacity&&e(this).attr("data-opacity",h(o.opacity,0,1)),o.color&&e(this).val(o.color)):e(this).val(o),r(e(this))}),e(this));default:return"create"!==s&&(o=s),e(this).each(function(){!function(t,i){var n,s,o,a,l,c=e('<div class="minicolors" />'),u=e.minicolors.defaults;if(!t.data("minicolors-initialized")){if(i=e.extend(!0,{},u,i),c.addClass("minicolors-theme-"+i.theme).toggleClass("minicolors-with-opacity",i.opacity).toggleClass("minicolors-no-data-uris",!0!==i.dataUris),void 0!==i.position&&e.each(i.position.split(" "),function(){c.addClass("minicolors-position-"+this)}),n="rgb"===i.format?i.opacity?"25":"20":i.keywords?"11":"7",t.addClass("minicolors-input").data("minicolors-initialized",!1).data("minicolors-settings",i).prop("size",n).wrap(c).after('<div class="minicolors-panel minicolors-slider-'+i.control+'"><div class="minicolors-slider minicolors-sprite"><div class="minicolors-picker"></div></div><div class="minicolors-opacity-slider minicolors-sprite"><div class="minicolors-picker"></div></div><div class="minicolors-grid minicolors-sprite"><div class="minicolors-grid-inner"></div><div class="minicolors-picker"><div></div></div></div></div>'),i.inline||(t.after('<span class="minicolors-swatch minicolors-sprite minicolors-input-swatch"><span class="minicolors-swatch-color"></span></span>'),t.next(".minicolors-input-swatch").on("click",function(e){e.preventDefault(),t.focus()})),(a=t.parent().find(".minicolors-panel")).on("selectstart",function(){return!1}).end(),i.swatches&&0!==i.swatches.length)for(i.swatches.length>7&&(i.swatches.length=7),a.addClass("minicolors-with-swatches"),s=e('<ul class="minicolors-swatches"></ul>').appendTo(a),l=0;l<i.swatches.length;++l)o=i.swatches[l],o=v(o)?p(o,!0):y(d(o,!0)),e('<li class="minicolors-swatch minicolors-sprite"><span class="minicolors-swatch-color"></span></li>').appendTo(s).data("swatch-color",i.swatches[l]).find(".minicolors-swatch-color").css({backgroundColor:m(o),opacity:o.a}),i.swatches[l]=o;i.inline&&t.parent().addClass("minicolors-inline"),r(t,!1),t.data("minicolors-initialized",!0)}}(e(this),o)}),e(this)}}}),e(document).on("mousedown.minicolors touchstart.minicolors",function(t){e(t.target).parents().add(t.target).hasClass("minicolors")||n()}).on("mousedown.minicolors touchstart.minicolors",".minicolors-grid, .minicolors-slider, .minicolors-opacity-slider",function(t){var i=e(this);t.preventDefault(),e(document).data("minicolors-target",i),s(i,t,!0)}).on("mousemove.minicolors touchmove.minicolors",function(t){var i=e(document).data("minicolors-target");i&&s(i,t)}).on("mouseup.minicolors touchend.minicolors",function(){e(this).removeData("minicolors-target")}).on("click.minicolors",".minicolors-swatches li",function(t){t.preventDefault();var i=e(this),n=i.parents(".minicolors").find(".minicolors-input"),s=i.data("swatch-color");a(n,s,f(s)),r(n)}).on("mousedown.minicolors touchstart.minicolors",".minicolors-input-swatch",function(t){var n=e(this).parent().find(".minicolors-input");t.preventDefault(),i(n)}).on("focus.minicolors",".minicolors-input",function(){var t=e(this);t.data("minicolors-initialized")&&i(t)}).on("blur.minicolors",".minicolors-input",function(){var t,i,n,s,o,a=e(this),r=a.data("minicolors-settings");a.data("minicolors-initialized")&&(t=r.keywords?e.map(r.keywords.split(","),function(t){return e.trim(t.toLowerCase())}):[],""!==a.val()&&e.inArray(a.val().toLowerCase(),t)>-1?o=a.val():(v(a.val())?n=p(a.val(),!0):(i=d(a.val(),!0),n=i?y(i):null),o=null===n?r.defaultValue:"rgb"===r.format?p(r.opacity?"rgba("+n.r+","+n.g+","+n.b+","+a.attr("data-opacity")+")":"rgb("+n.r+","+n.g+","+n.b+")"):m(n)),s=r.opacity?a.attr("data-opacity"):1,"transparent"===o.toLowerCase()&&(s=0),a.closest(".minicolors").find(".minicolors-input-swatch > span").css("opacity",s),a.val(o),""===a.val()&&a.val(u(r.defaultValue,!0)),a.val(c(a.val(),r.letterCase)))}).on("keydown.minicolors",".minicolors-input",function(t){var i=e(this);if(i.data("minicolors-initialized"))switch(t.keyCode){case 9:n();break;case 13:case 27:n(),i.blur()}}).on("keyup.minicolors",".minicolors-input",function(){var t=e(this);t.data("minicolors-initialized")&&r(t,!0)}).on("paste.minicolors",".minicolors-input",function(){var t=e(this);t.data("minicolors-initialized")&&setTimeout(function(){r(t,!0)},1)})}),function(e,t){"function"==typeof define&&define.amd?define("sifter",t):"object"==typeof exports?module.exports=t():e.Sifter=t()}(this,function(){var e=function(e,t){this.items=e,this.settings=t||{diacritics:!0}};e.prototype.tokenize=function(e){if(!(e=n(String(e||"").toLowerCase()))||!e.length)return[];var t,i,o,r,l=[],c=e.split(/ +/);for(t=0,i=c.length;i>t;t++){if(o=s(c[t]),this.settings.diacritics)for(r in a)a.hasOwnProperty(r)&&(o=o.replace(new RegExp(r,"g"),a[r]));l.push({string:c[t],regex:new RegExp(o,"i")})}return l},e.prototype.iterator=function(e,t){(o(e)?Array.prototype.forEach||function(e){for(var t=0,i=this.length;i>t;t++)e(this[t],t,this)}:function(e){for(var t in this)this.hasOwnProperty(t)&&e(this[t],t,this)}).apply(e,[t])},e.prototype.getScoreFunction=function(e,t){var i,n,s;e=this.prepareSearch(e,t),n=e.tokens,i=e.options.fields,s=n.length;var o=function(e,t){var i,n;return e?-1===(n=(e=String(e||"")).search(t.regex))?0:(i=t.string.length/e.length,0===n&&(i+=.5),i):0},a=function(){var e=i.length;return e?1===e?function(e,t){return o(t[i[0]],e)}:function(t,n){for(var s=0,a=0;e>s;s++)a+=o(n[i[s]],t);return a/e}:function(){return 0}}();return s?1===s?function(e){return a(n[0],e)}:"and"===e.options.conjunction?function(e){for(var t,i=0,o=0;s>i;i++){if(0>=(t=a(n[i],e)))return 0;o+=t}return o/s}:function(e){for(var t=0,i=0;s>t;t++)i+=a(n[t],e);return i/s}:function(){return 0}},e.prototype.getSortFunction=function(e,i){var n,s,o,a,r,l,c,d,p,u,h;if(h=!(e=(o=this).prepareSearch(e,i)).query&&i.sort_empty||i.sort,p=function(e,t){return"$score"===e?t.score:o.items[t.id][e]},r=[],h)for(n=0,s=h.length;s>n;n++)(e.query||"$score"!==h[n].field)&&r.push(h[n]);if(e.query){for(u=!0,n=0,s=r.length;s>n;n++)if("$score"===r[n].field){u=!1;break}u&&r.unshift({field:"$score",direction:"desc"})}else for(n=0,s=r.length;s>n;n++)if("$score"===r[n].field){r.splice(n,1);break}for(d=[],n=0,s=r.length;s>n;n++)d.push("desc"===r[n].direction?-1:1);return(l=r.length)?1===l?(a=r[0].field,c=d[0],function(e,i){return c*t(p(a,e),p(a,i))}):function(e,i){var n,s,o;for(n=0;l>n;n++)if(o=r[n].field,s=d[n]*t(p(o,e),p(o,i)))return s;return 0}:null},e.prototype.prepareSearch=function(e,t){if("object"==typeof e)return e;var n=(t=i({},t)).fields,s=t.sort,a=t.sort_empty;return n&&!o(n)&&(t.fields=[n]),s&&!o(s)&&(t.sort=[s]),a&&!o(a)&&(t.sort_empty=[a]),{options:t,query:String(e||"").toLowerCase(),tokens:this.tokenize(e),total:0,items:[]}},e.prototype.search=function(e,t){var i,n,s,o;return n=this.prepareSearch(e,t),t=n.options,e=n.query,o=t.score||this.getScoreFunction(n),e.length?this.iterator(this.items,function(e,s){i=o(e),(!1===t.filter||i>0)&&n.items.push({score:i,id:s})}):this.iterator(this.items,function(e,t){n.items.push({score:1,id:t})}),(s=this.getSortFunction(n,t))&&n.items.sort(s),n.total=n.items.length,"number"==typeof t.limit&&(n.items=n.items.slice(0,t.limit)),n};var t=function(e,t){return"number"==typeof e&&"number"==typeof t?e>t?1:t>e?-1:0:(e=r(String(e||"")))>(t=r(String(t||"")))?1:t>e?-1:0},i=function(e){var t,i,n,s;for(t=1,i=arguments.length;i>t;t++)if(s=arguments[t])for(n in s)s.hasOwnProperty(n)&&(e[n]=s[n]);return e},n=function(e){return(e+"").replace(/^\s+|\s+$|/g,"")},s=function(e){return(e+"").replace(/([.?*+^$[\]\\(){}|-])/g,"\\$1")},o=Array.isArray||$&&$.isArray||function(e){return"[object Array]"===Object.prototype.toString.call(e)},a={a:"[aÀÁÂÃÄÅàáâãäåĀāąĄ]",c:"[cÇçćĆčČ]",d:"[dđĐďĎ]",e:"[eÈÉÊËèéêëěĚĒēęĘ]",i:"[iÌÍÎÏìíîïĪī]",l:"[lłŁ]",n:"[nÑñňŇńŃ]",o:"[oÒÓÔÕÕÖØòóôõöøŌō]",r:"[rřŘ]",s:"[sŠšśŚ]",t:"[tťŤ]",u:"[uÙÚÛÜùúûüůŮŪū]",y:"[yŸÿýÝ]",z:"[zŽžżŻźŹ]"},r=function(){var e,t,i,n,s="",o={};for(i in a)if(a.hasOwnProperty(i))for(n=a[i].substring(2,a[i].length-1),s+=n,e=0,t=n.length;t>e;e++)o[n.charAt(e)]=i;var r=new RegExp("["+s+"]","g");return function(e){return e.replace(r,function(e){return o[e]}).toLowerCase()}}();return e}),function(e,t){"function"==typeof define&&define.amd?define("microplugin",t):"object"==typeof exports?module.exports=t():e.MicroPlugin=t()}(this,function(){var e={};e.mixin=function(e){e.plugins={},e.prototype.initializePlugins=function(e){var i,n,s,o=[];if(this.plugins={names:[],settings:{},requested:{},loaded:{}},t.isArray(e))for(i=0,n=e.length;n>i;i++)"string"==typeof e[i]?o.push(e[i]):(this.plugins.settings[e[i].name]=e[i].options,o.push(e[i].name));else if(e)for(s in e)e.hasOwnProperty(s)&&(this.plugins.settings[s]=e[s],o.push(s));for(;o.length;)this.require(o.shift())},e.prototype.loadPlugin=function(t){var i=this.plugins,n=e.plugins[t];if(!e.plugins.hasOwnProperty(t))throw new Error('Unable to find "'+t+'" plugin');i.requested[t]=!0,i.loaded[t]=n.fn.apply(this,[this.plugins.settings[t]||{}]),i.names.push(t)},e.prototype.require=function(e){var t=this.plugins;if(!this.plugins.loaded.hasOwnProperty(e)){if(t.requested[e])throw new Error('Plugin has circular dependency ("'+e+'")');this.loadPlugin(e)}return t.loaded[e]},e.define=function(t,i){e.plugins[t]={name:t,fn:i}}};var t={isArray:Array.isArray||function(e){return"[object Array]"===Object.prototype.toString.call(e)}};return e}),function(e,t){"function"==typeof define&&define.amd?define("selectize",["jquery","sifter","microplugin"],t):"object"==typeof exports?module.exports=t(require("jquery"),require("sifter"),require("microplugin")):e.Selectize=t(e.jQuery,e.Sifter,e.MicroPlugin)}(this,function(e,t,i){var n=function(e,t){if("string"!=typeof t||t.length){var i="string"==typeof t?new RegExp(t,"i"):t,n=function(e){var t=0;if(3===e.nodeType){var s=e.data.search(i);if(s>=0&&e.data.length>0){var o=e.data.match(i),a=document.createElement("span");a.className="highlight";var r=e.splitText(s),l=(r.splitText(o[0].length),r.cloneNode(!0));a.appendChild(l),r.parentNode.replaceChild(a,r),t=1}}else if(1===e.nodeType&&e.childNodes&&!/(script|style)/i.test(e.tagName))for(var c=0;c<e.childNodes.length;++c)c+=n(e.childNodes[c]);return t};return e.each(function(){n(this)})}},s=function(){};s.prototype={on:function(e,t){this._events=this._events||{},this._events[e]=this._events[e]||[],this._events[e].push(t)},off:function(e,t){var i=arguments.length;return 0===i?delete this._events:1===i?delete this._events[e]:(this._events=this._events||{},void(e in this._events!=0&&this._events[e].splice(this._events[e].indexOf(t),1)))},trigger:function(e){if(this._events=this._events||{},e in this._events!=0)for(var t=0;t<this._events[e].length;t++)this._events[e][t].apply(this,Array.prototype.slice.call(arguments,1))}},s.mixin=function(e){for(var t=["on","off","trigger"],i=0;i<t.length;i++)e.prototype[t[i]]=s.prototype[t[i]]};var o=/Mac/.test(navigator.userAgent),a=o?91:17,r=o?18:17,l=!/android/i.test(window.navigator.userAgent)&&!!document.createElement("form").validity,c=function(e){return void 0!==e},d=function(e){return void 0===e||null===e?null:"boolean"==typeof e?e?"1":"0":e+""},p=function(e){return(e+"").replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;")},u=function(e){return(e+"").replace(/\$/g,"$$$$")},h={};h.before=function(e,t,i){var n=e[t];e[t]=function(){return i.apply(e,arguments),n.apply(e,arguments)}},h.after=function(e,t,i){var n=e[t];e[t]=function(){var t=n.apply(e,arguments);return i.apply(e,arguments),t}};var v=function(e,t,i){var n,s=e.trigger,o={};e.trigger=function(){var i=arguments[0];return-1===t.indexOf(i)?s.apply(e,arguments):void(o[i]=arguments)},i.apply(e,[]),e.trigger=s;for(n in o)o.hasOwnProperty(n)&&s.apply(e,o[n])},f=function(e){var t={};if("selectionStart"in e)t.start=e.selectionStart,t.length=e.selectionEnd-t.start;else if(document.selection){e.focus();var i=document.selection.createRange(),n=document.selection.createRange().text.length;i.moveStart("character",-e.value.length),t.start=i.text.length-n,t.length=n}return t},g=function(t){var i=null,n=function(n,s){var o,a,r,l,c,d,p,u;n=n||window.event||{},s=s||{},n.metaKey||n.altKey||(s.force||!1!==t.data("grow"))&&(o=t.val(),n.type&&"keydown"===n.type.toLowerCase()&&(a=n.keyCode,r=a>=97&&122>=a||a>=65&&90>=a||a>=48&&57>=a||32===a,46===a||8===a?(u=f(t[0]),u.length?o=o.substring(0,u.start)+o.substring(u.start+u.length):8===a&&u.start?o=o.substring(0,u.start-1)+o.substring(u.start+1):46===a&&void 0!==u.start&&(o=o.substring(0,u.start)+o.substring(u.start+1))):r&&(d=n.shiftKey,p=String.fromCharCode(n.keyCode),p=d?p.toUpperCase():p.toLowerCase(),o+=p)),l=t.attr("placeholder"),!o&&l&&(o=l),c=function(t,i){if(!t)return 0;var n=e("<test>").css({position:"absolute",top:-99999,left:-99999,width:"auto",padding:0,whiteSpace:"pre"}).text(t).appendTo("body");!function(e,t,i){var n,s,o={};if(i)for(n=0,s=i.length;s>n;n++)o[i[n]]=e.css(i[n]);else o=e.css();t.css(o)}(i,n,["letterSpacing","fontSize","fontFamily","fontWeight","textTransform"]);var s=n.width();return n.remove(),s}(o,t)+4,c!==i&&(i=c,t.width(c),t.triggerHandler("resize")))};t.on("keydown keyup update blur",n),n()},m=function(i,n){var s,o,a,r;(r=i[0]).selectize=this;var l=window.getComputedStyle&&window.getComputedStyle(r,null);if(a=(a=l?l.getPropertyValue("direction"):r.currentStyle&&r.currentStyle.direction)||i.parents("[dir]:first").attr("dir")||"",e.extend(this,{order:0,settings:n,$input:i,tabIndex:i.attr("tabindex")||"",tagType:"select"===r.tagName.toLowerCase()?1:2,rtl:/rtl/i.test(a),eventNS:".selectize"+ ++m.count,highlightedValue:null,isOpen:!1,isDisabled:!1,isRequired:i.is("[required]"),isInvalid:!1,isLocked:!1,isFocused:!1,isInputHidden:!1,isSetup:!1,isShiftDown:!1,isCmdDown:!1,isCtrlDown:!1,ignoreFocus:!1,ignoreBlur:!1,ignoreHover:!1,hasOptions:!1,currentResults:null,lastValue:"",caretPos:0,loading:0,loadedSearches:{},$activeOption:null,$activeItems:[],optgroups:{},options:{},userOptions:{},items:[],renderCache:{},onSearchChange:null===n.loadThrottle?this.onSearchChange:function(e,t){var i;return function(){var n=this,s=arguments;window.clearTimeout(i),i=window.setTimeout(function(){e.apply(n,s)},t)}}(this.onSearchChange,n.loadThrottle)}),this.sifter=new t(this.options,{diacritics:n.diacritics}),this.settings.options){for(s=0,o=this.settings.options.length;o>s;s++)this.registerOption(this.settings.options[s]);delete this.settings.options}if(this.settings.optgroups){for(s=0,o=this.settings.optgroups.length;o>s;s++)this.registerOptionGroup(this.settings.optgroups[s]);delete this.settings.optgroups}this.settings.mode=this.settings.mode||(1===this.settings.maxItems?"single":"multi"),"boolean"!=typeof this.settings.hideSelected&&(this.settings.hideSelected="multi"===this.settings.mode),this.initializePlugins(this.settings.plugins),this.setupCallbacks(),this.setupTemplates(),this.setup()};return s.mixin(m),i.mixin(m),e.extend(m.prototype,{setup:function(){var t,i,n,s,c,d,p,u,h,v=this,f=v.settings,m=v.eventNS,w=e(window),y=e(document),b=v.$input;if(p=v.settings.mode,u=b.attr("class")||"",t=e("<div>").addClass(f.wrapperClass).addClass(u).addClass(p),i=e("<div>").addClass(f.inputClass).addClass("items").appendTo(t),n=e('<input type="text" autocomplete="off" />').appendTo(i).attr("tabindex",b.is(":disabled")?"-1":v.tabIndex),d=e(f.dropdownParent||t),s=e("<div>").addClass(f.dropdownClass).addClass(p).hide().appendTo(d),c=e("<div>").addClass(f.dropdownContentClass).appendTo(s),v.settings.copyClassesToDropdown&&s.addClass(u),t.css({width:b[0].style.width}),v.plugins.names.length&&(h="plugin-"+v.plugins.names.join(" plugin-"),t.addClass(h),s.addClass(h)),(null===f.maxItems||f.maxItems>1)&&1===v.tagType&&b.attr("multiple","multiple"),v.settings.placeholder&&n.attr("placeholder",f.placeholder),!v.settings.splitOn&&v.settings.delimiter){var C=v.settings.delimiter.replace(/[-\/\\^$*+?.()|[\]{}]/g,"\\$&");v.settings.splitOn=new RegExp("\\s*"+C+"+\\s*")}b.attr("autocorrect")&&n.attr("autocorrect",b.attr("autocorrect")),b.attr("autocapitalize")&&n.attr("autocapitalize",b.attr("autocapitalize")),v.$wrapper=t,v.$control=i,v.$control_input=n,v.$dropdown=s,v.$dropdown_content=c,s.on("mouseenter","[data-selectable]",function(){return v.onOptionHover.apply(v,arguments)}),s.on("mousedown click","[data-selectable]",function(){return v.onOptionSelect.apply(v,arguments)}),x="mousedown",k="*:not(input)",O=function(){return v.onItemSelect.apply(v,arguments)},(_=i).on(x,k,function(e){for(var t=e.target;t&&t.parentNode!==_[0];)t=t.parentNode;return e.currentTarget=t,O.apply(this,[e])}),g(n),i.on({mousedown:function(){return v.onMouseDown.apply(v,arguments)},click:function(){return v.onClick.apply(v,arguments)}}),n.on({mousedown:function(e){e.stopPropagation()},keydown:function(){return v.onKeyDown.apply(v,arguments)},keyup:function(){return v.onKeyUp.apply(v,arguments)},keypress:function(){return v.onKeyPress.apply(v,arguments)},resize:function(){v.positionDropdown.apply(v,[])},blur:function(){return v.onBlur.apply(v,arguments)},focus:function(){return v.ignoreBlur=!1,v.onFocus.apply(v,arguments)},paste:function(){return v.onPaste.apply(v,arguments)}}),y.on("keydown"+m,function(e){v.isCmdDown=e[o?"metaKey":"ctrlKey"],v.isCtrlDown=e[o?"altKey":"ctrlKey"],v.isShiftDown=e.shiftKey}),y.on("keyup"+m,function(e){e.keyCode===r&&(v.isCtrlDown=!1),16===e.keyCode&&(v.isShiftDown=!1),e.keyCode===a&&(v.isCmdDown=!1)}),y.on("mousedown"+m,function(e){if(v.isFocused){if(e.target===v.$dropdown[0]||e.target.parentNode===v.$dropdown[0])return!1;v.$control.has(e.target).length||e.target===v.$control[0]||v.blur(e.target)}}),w.on(["scroll"+m,"resize"+m].join(" "),function(){v.isOpen&&v.positionDropdown.apply(v,arguments)}),w.on("mousemove"+m,function(){v.ignoreHover=!1}),this.revertSettings={$children:b.children().detach(),tabindex:b.attr("tabindex")},b.attr("tabindex",-1).hide().after(v.$wrapper),e.isArray(f.items)&&(v.setValue(f.items),delete f.items),l&&b.on("invalid"+m,function(e){e.preventDefault(),v.isInvalid=!0,v.refreshState()}),v.updateOriginalInput(),v.refreshItems(),v.refreshState(),v.updatePlaceholder(),v.isSetup=!0,b.is(":disabled")&&v.disable(),v.on("change",this.onChange),b.data("selectize",v),b.addClass("selectized"),v.trigger("initialize"),!0===f.preload&&v.onSearchChange("");var _,x,k,O},setupTemplates:function(){var t=this.settings.labelField,i=this.settings.optgroupLabelField,n={optgroup:function(e){return'<div class="optgroup">'+e.html+"</div>"},optgroup_header:function(e,t){return'<div class="optgroup-header">'+t(e[i])+"</div>"},option:function(e,i){return'<div class="option">'+i(e[t])+"</div>"},item:function(e,i){return'<div class="item">'+i(e[t])+"</div>"},option_create:function(e,t){return'<div class="create">Add <strong>'+t(e.input)+"</strong>&hellip;</div>"}};this.settings.render=e.extend({},n,this.settings.render)},setupCallbacks:function(){var e,t,i={initialize:"onInitialize",change:"onChange",item_add:"onItemAdd",item_remove:"onItemRemove",clear:"onClear",option_add:"onOptionAdd",option_remove:"onOptionRemove",option_clear:"onOptionClear",optgroup_add:"onOptionGroupAdd",optgroup_remove:"onOptionGroupRemove",optgroup_clear:"onOptionGroupClear",dropdown_open:"onDropdownOpen",dropdown_close:"onDropdownClose",type:"onType",load:"onLoad",focus:"onFocus",blur:"onBlur"};for(e in i)i.hasOwnProperty(e)&&(t=this.settings[i[e]],t&&this.on(e,t))},onClick:function(e){this.isFocused||(this.focus(),e.preventDefault())},onMouseDown:function(t){var i=this,n=t.isDefaultPrevented();if(e(t.target),i.isFocused){if(t.target!==i.$control_input[0])return"single"===i.settings.mode?i.isOpen?i.close():i.open():n||i.setActiveItem(null),!1}else n||window.setTimeout(function(){i.focus()},0)},onChange:function(){this.$input.trigger("change")},onPaste:function(t){var i=this;i.isFull()||i.isInputHidden||i.isLocked?t.preventDefault():i.settings.splitOn&&setTimeout(function(){for(var t=e.trim(i.$control_input.val()||"").split(i.settings.splitOn),n=0,s=t.length;s>n;n++)i.createItem(t[n])},0)},onKeyPress:function(e){if(this.isLocked)return e&&e.preventDefault();var t=String.fromCharCode(e.keyCode||e.which);return this.settings.create&&"multi"===this.settings.mode&&t===this.settings.delimiter?(this.createItem(),e.preventDefault(),!1):void 0},onKeyDown:function(e){var t=(e.target,this.$control_input[0],this);{if(!t.isLocked){switch(e.keyCode){case 65:if(t.isCmdDown)return void t.selectAll();break;case 27:return void(t.isOpen&&(e.preventDefault(),e.stopPropagation(),t.close()));case 78:if(!e.ctrlKey||e.altKey)break;case 40:if(!t.isOpen&&t.hasOptions)t.open();else if(t.$activeOption){t.ignoreHover=!0;var i=t.getAdjacentOption(t.$activeOption,1);i.length&&t.setActiveOption(i,!0,!0)}return void e.preventDefault();case 80:if(!e.ctrlKey||e.altKey)break;case 38:if(t.$activeOption){t.ignoreHover=!0;var n=t.getAdjacentOption(t.$activeOption,-1);n.length&&t.setActiveOption(n,!0,!0)}return void e.preventDefault();case 13:return void(t.isOpen&&t.$activeOption&&(t.onOptionSelect({currentTarget:t.$activeOption}),e.preventDefault()));case 37:return void t.advanceSelection(-1,e);case 39:return void t.advanceSelection(1,e);case 9:return t.settings.selectOnTab&&t.isOpen&&t.$activeOption&&(t.onOptionSelect({currentTarget:t.$activeOption}),t.isFull()||e.preventDefault()),void(t.settings.create&&t.createItem()&&e.preventDefault());case 8:case 46:return void t.deleteSelection(e)}return!t.isFull()&&!t.isInputHidden||(o?e.metaKey:e.ctrlKey)?void 0:void e.preventDefault()}9!==e.keyCode&&e.preventDefault()}},onKeyUp:function(e){if(this.isLocked)return e&&e.preventDefault();var t=this.$control_input.val()||"";this.lastValue!==t&&(this.lastValue=t,this.onSearchChange(t),this.refreshOptions(),this.trigger("type",t))},onSearchChange:function(e){var t=this,i=t.settings.load;i&&(t.loadedSearches.hasOwnProperty(e)||(t.loadedSearches[e]=!0,t.load(function(n){i.apply(t,[e,n])})))},onFocus:function(e){var t=this.isFocused;return this.isDisabled?(this.blur(),e&&e.preventDefault(),!1):void(this.ignoreFocus||(this.isFocused=!0,"focus"===this.settings.preload&&this.onSearchChange(""),t||this.trigger("focus"),this.$activeItems.length||(this.showInput(),this.setActiveItem(null),this.refreshOptions(!!this.settings.openOnFocus)),this.refreshState()))},onBlur:function(e,t){var i=this;if(i.isFocused&&(i.isFocused=!1,!i.ignoreFocus)){if(!i.ignoreBlur&&document.activeElement===i.$dropdown_content[0])return i.ignoreBlur=!0,void i.onFocus(e);var n=function(){i.close(),i.setTextboxValue(""),i.setActiveItem(null),i.setActiveOption(null),i.setCaret(i.items.length),i.refreshState(),(t||document.body).focus(),i.ignoreFocus=!1,i.trigger("blur")};i.ignoreFocus=!0,i.settings.create&&i.settings.createOnBlur?i.createItem(null,!1,n):n()}},onOptionHover:function(e){this.ignoreHover||this.setActiveOption(e.currentTarget,!1)},onOptionSelect:function(t){var i,n,s=this;t.preventDefault&&(t.preventDefault(),t.stopPropagation()),(n=e(t.currentTarget)).hasClass("create")?s.createItem(null,function(){s.settings.closeAfterSelect&&s.close()}):void 0!==(i=n.attr("data-value"))&&(s.lastQuery=null,s.setTextboxValue(""),s.addItem(i),s.settings.closeAfterSelect?s.close():!s.settings.hideSelected&&t.type&&/mouse/.test(t.type)&&s.setActiveOption(s.getOption(i)))},onItemSelect:function(e){this.isLocked||"multi"===this.settings.mode&&(e.preventDefault(),this.setActiveItem(e.currentTarget,e))},load:function(e){var t=this,i=t.$wrapper.addClass(t.settings.loadingClass);t.loading++,e.apply(t,[function(e){t.loading=Math.max(t.loading-1,0),e&&e.length&&(t.addOption(e),t.refreshOptions(t.isFocused&&!t.isInputHidden)),t.loading||i.removeClass(t.settings.loadingClass),t.trigger("load",e)}])},setTextboxValue:function(e){var t=this.$control_input;t.val()!==e&&(t.val(e).triggerHandler("update"),this.lastValue=e)},getValue:function(){return 1===this.tagType&&this.$input.attr("multiple")?this.items:this.items.join(this.settings.delimiter)},setValue:function(e,t){v(this,t?[]:["change"],function(){this.clear(t),this.addItems(e,t)})},setActiveItem:function(t,i){var n,s,o,a,r,l,c,d;if("single"!==this.settings.mode){if(!(t=e(t)).length)return e(this.$activeItems).removeClass("active"),this.$activeItems=[],void(this.isFocused&&this.showInput());if("mousedown"===(n=i&&i.type.toLowerCase())&&this.isShiftDown&&this.$activeItems.length){for(d=this.$control.children(".active:last"),(a=Array.prototype.indexOf.apply(this.$control[0].childNodes,[d[0]]))>(r=Array.prototype.indexOf.apply(this.$control[0].childNodes,[t[0]]))&&(c=a,a=r,r=c),s=a;r>=s;s++)l=this.$control[0].childNodes[s],-1===this.$activeItems.indexOf(l)&&(e(l).addClass("active"),this.$activeItems.push(l));i.preventDefault()}else"mousedown"===n&&this.isCtrlDown||"keydown"===n&&this.isShiftDown?t.hasClass("active")?(o=this.$activeItems.indexOf(t[0]),this.$activeItems.splice(o,1),t.removeClass("active")):this.$activeItems.push(t.addClass("active")[0]):(e(this.$activeItems).removeClass("active"),this.$activeItems=[t.addClass("active")[0]]);this.hideInput(),this.isFocused||this.focus()}},setActiveOption:function(t,i,n){var s,o,a,r,l;this.$activeOption&&this.$activeOption.removeClass("active"),this.$activeOption=null,(t=e(t)).length&&(this.$activeOption=t.addClass("active"),(i||!c(i))&&(s=this.$dropdown_content.height(),o=this.$activeOption.outerHeight(!0),i=this.$dropdown_content.scrollTop()||0,a=this.$activeOption.offset().top-this.$dropdown_content.offset().top+i,r=a,l=a-s+o,a+o>s+i?this.$dropdown_content.stop().animate({scrollTop:l},n?this.settings.scrollDuration:0):i>a&&this.$dropdown_content.stop().animate({scrollTop:r},n?this.settings.scrollDuration:0)))},selectAll:function(){"single"!==this.settings.mode&&(this.$activeItems=Array.prototype.slice.apply(this.$control.children(":not(input)").addClass("active")),this.$activeItems.length&&(this.hideInput(),this.close()),this.focus())},hideInput:function(){this.setTextboxValue(""),this.$control_input.css({opacity:0,position:"absolute",left:this.rtl?1e4:-1e4}),this.isInputHidden=!0},showInput:function(){this.$control_input.css({opacity:1,position:"relative",left:0}),this.isInputHidden=!1},focus:function(){var e=this;e.isDisabled||(e.ignoreFocus=!0,e.$control_input[0].focus(),window.setTimeout(function(){e.ignoreFocus=!1,e.onFocus()},0))},blur:function(e){this.$control_input[0].blur(),this.onBlur(null,e)},getScoreFunction:function(e){return this.sifter.getScoreFunction(e,this.getSearchOptions())},getSearchOptions:function(){var e=this.settings,t=e.sortField;return"string"==typeof t&&(t=[{field:t}]),{fields:e.searchField,conjunction:e.searchConjunction,sort:t}},search:function(t){var i,n,s,o=this.settings,a=this.getSearchOptions();if(o.score&&(s=this.settings.score.apply(this,[t]),"function"!=typeof s))throw new Error('Selectize "score" setting must be a function that returns a function');if(t!==this.lastQuery?(this.lastQuery=t,n=this.sifter.search(t,e.extend(a,{score:s})),this.currentResults=n):n=e.extend(!0,{},this.currentResults),o.hideSelected)for(i=n.items.length-1;i>=0;i--)-1!==this.items.indexOf(d(n.items[i].id))&&n.items.splice(i,1);return n},refreshOptions:function(t){var i,s,o,a,r,l,c,p,u,h,v,f,g,m,w,y;void 0===t&&(t=!0);var b=this,C=e.trim(b.$control_input.val()),_=b.search(C),x=b.$dropdown_content,k=b.$activeOption&&d(b.$activeOption.attr("data-value"));for(a=_.items.length,"number"==typeof b.settings.maxOptions&&(a=Math.min(a,b.settings.maxOptions)),r={},l=[],i=0;a>i;i++)for(c=b.options[_.items[i].id],p=b.render("option",c),u=c[b.settings.optgroupField]||"",h=e.isArray(u)?u:[u],s=0,o=h&&h.length;o>s;s++)u=h[s],b.optgroups.hasOwnProperty(u)||(u=""),r.hasOwnProperty(u)||(r[u]=[],l.push(u)),r[u].push(p);for(this.settings.lockOptgroupOrder&&l.sort(function(e,t){return(b.optgroups[e].$order||0)-(b.optgroups[t].$order||0)}),v=[],i=0,a=l.length;a>i;i++)u=l[i],b.optgroups.hasOwnProperty(u)&&r[u].length?(f=b.render("optgroup_header",b.optgroups[u])||"",f+=r[u].join(""),v.push(b.render("optgroup",e.extend({},b.optgroups[u],{html:f})))):v.push(r[u].join(""));if(x.html(v.join("")),b.settings.highlight&&_.query.length&&_.tokens.length)for(i=0,a=_.tokens.length;a>i;i++)n(x,_.tokens[i].regex);if(!b.settings.hideSelected)for(i=0,a=b.items.length;a>i;i++)b.getOption(b.items[i]).addClass("selected");(g=b.canCreate(C))&&(x.prepend(b.render("option_create",{input:C})),y=e(x[0].childNodes[0])),b.hasOptions=_.items.length>0||g,b.hasOptions?(_.items.length>0?((w=k&&b.getOption(k))&&w.length?m=w:"single"===b.settings.mode&&b.items.length&&(m=b.getOption(b.items[0])),m&&m.length||(m=y&&!b.settings.addPrecedence?b.getAdjacentOption(y,1):x.find("[data-selectable]:first"))):m=y,b.setActiveOption(m),t&&!b.isOpen&&b.open()):(b.setActiveOption(null),t&&b.isOpen&&b.close())},addOption:function(t){var i,n,s;if(e.isArray(t))for(i=0,n=t.length;n>i;i++)this.addOption(t[i]);else(s=this.registerOption(t))&&(this.userOptions[s]=!0,this.lastQuery=null,this.trigger("option_add",s,t))},registerOption:function(e){var t=d(e[this.settings.valueField]);return!(!t||this.options.hasOwnProperty(t))&&(e.$order=e.$order||++this.order,this.options[t]=e,t)},registerOptionGroup:function(e){var t=d(e[this.settings.optgroupValueField]);return!!t&&(e.$order=e.$order||++this.order,this.optgroups[t]=e,t)},addOptionGroup:function(e,t){t[this.settings.optgroupValueField]=e,(e=this.registerOptionGroup(t))&&this.trigger("optgroup_add",e,t)},removeOptionGroup:function(e){this.optgroups.hasOwnProperty(e)&&(delete this.optgroups[e],this.renderCache={},this.trigger("optgroup_remove",e))},clearOptionGroups:function(){this.optgroups={},this.renderCache={},this.trigger("optgroup_clear")},updateOption:function(t,i){var n,s,o,a,r,l,c;if(t=d(t),o=d(i[this.settings.valueField]),null!==t&&this.options.hasOwnProperty(t)){if("string"!=typeof o)throw new Error("Value must be set in option data");c=this.options[t].$order,o!==t&&(delete this.options[t],a=this.items.indexOf(t),-1!==a&&this.items.splice(a,1,o)),i.$order=i.$order||c,this.options[o]=i,r=this.renderCache.item,l=this.renderCache.option,r&&(delete r[t],delete r[o]),l&&(delete l[t],delete l[o]),-1!==this.items.indexOf(o)&&(n=this.getItem(t),s=e(this.render("item",i)),n.hasClass("active")&&s.addClass("active"),n.replaceWith(s)),this.lastQuery=null,this.isOpen&&this.refreshOptions(!1)}},removeOption:function(e,t){e=d(e);var i=this.renderCache.item,n=this.renderCache.option;i&&delete i[e],n&&delete n[e],delete this.userOptions[e],delete this.options[e],this.lastQuery=null,this.trigger("option_remove",e),this.removeItem(e,t)},clearOptions:function(){this.loadedSearches={},this.userOptions={},this.renderCache={},this.options=this.sifter.items={},this.lastQuery=null,this.trigger("option_clear"),this.clear()},getOption:function(e){return this.getElementWithValue(e,this.$dropdown_content.find("[data-selectable]"))},getAdjacentOption:function(t,i){var n=this.$dropdown.find("[data-selectable]"),s=n.index(t)+i;return s>=0&&s<n.length?n.eq(s):e()},getElementWithValue:function(t,i){if(void 0!==(t=d(t))&&null!==t)for(var n=0,s=i.length;s>n;n++)if(i[n].getAttribute("data-value")===t)return e(i[n]);return e()},getItem:function(e){return this.getElementWithValue(e,this.$control.children())},addItems:function(t,i){for(var n=e.isArray(t)?t:[t],s=0,o=n.length;o>s;s++)this.isPending=o-1>s,this.addItem(n[s],i)},addItem:function(t,i){v(this,i?[]:["change"],function(){var n,s,o,a,r,l=this.settings.mode;return t=d(t),-1!==this.items.indexOf(t)?void("single"===l&&this.close()):void(this.options.hasOwnProperty(t)&&("single"===l&&this.clear(i),"multi"===l&&this.isFull()||(n=e(this.render("item",this.options[t])),r=this.isFull(),this.items.splice(this.caretPos,0,t),this.insertAtCaret(n),(!this.isPending||!r&&this.isFull())&&this.refreshState(),this.isSetup&&(o=this.$dropdown_content.find("[data-selectable]"),this.isPending||(s=this.getOption(t),a=this.getAdjacentOption(s,1).attr("data-value"),this.refreshOptions(this.isFocused&&"single"!==l),a&&this.setActiveOption(this.getOption(a))),!o.length||this.isFull()?this.close():this.positionDropdown(),this.updatePlaceholder(),this.trigger("item_add",t,n),this.updateOriginalInput({silent:i})))))})},removeItem:function(e,t){var i,n,s;i="object"==typeof e?e:this.getItem(e),e=d(i.attr("data-value")),-1!==(n=this.items.indexOf(e))&&(i.remove(),i.hasClass("active")&&(s=this.$activeItems.indexOf(i[0]),this.$activeItems.splice(s,1)),this.items.splice(n,1),this.lastQuery=null,!this.settings.persist&&this.userOptions.hasOwnProperty(e)&&this.removeOption(e,t),n<this.caretPos&&this.setCaret(this.caretPos-1),this.refreshState(),this.updatePlaceholder(),this.updateOriginalInput({silent:t}),this.positionDropdown(),this.trigger("item_remove",e,i))},createItem:function(t,i){var n=this,s=n.caretPos;t=t||e.trim(n.$control_input.val()||"");var o=arguments[arguments.length-1];if("function"!=typeof o&&(o=function(){}),"boolean"!=typeof i&&(i=!0),!n.canCreate(t))return o(),!1;n.lock();var a="function"==typeof n.settings.create?this.settings.create:function(e){var t={};return t[n.settings.labelField]=e,t[n.settings.valueField]=e,t},r=function(e){var t=!1;return function(){t||(t=!0,e.apply(this,arguments))}}(function(e){if(n.unlock(),!e||"object"!=typeof e)return o();var t=d(e[n.settings.valueField]);return"string"!=typeof t?o():(n.setTextboxValue(""),n.addOption(e),n.setCaret(s),n.addItem(t),n.refreshOptions(i&&"single"!==n.settings.mode),void o(e))}),l=a.apply(this,[t,r]);return void 0!==l&&r(l),!0},refreshItems:function(){this.lastQuery=null,this.isSetup&&this.addItem(this.items),this.refreshState(),this.updateOriginalInput()},refreshState:function(){this.isRequired&&(this.items.length&&(this.isInvalid=!1),this.$control_input.prop("required",void 0)),this.refreshClasses()},refreshClasses:function(){var t=this.isFull(),i=this.isLocked;this.$wrapper.toggleClass("rtl",this.rtl),this.$control.toggleClass("focus",this.isFocused).toggleClass("disabled",this.isDisabled).toggleClass("required",this.isRequired).toggleClass("invalid",this.isInvalid).toggleClass("locked",i).toggleClass("full",t).toggleClass("not-full",!t).toggleClass("input-active",this.isFocused&&!this.isInputHidden).toggleClass("dropdown-active",this.isOpen).toggleClass("has-options",!e.isEmptyObject(this.options)).toggleClass("has-items",this.items.length>0),this.$control_input.data("grow",!t&&!i)},isFull:function(){return null!==this.settings.maxItems&&this.items.length>=this.settings.maxItems},updateOriginalInput:function(e){var t,i,n,s;if(e=e||{},1===this.tagType){for(n=[],t=0,i=this.items.length;i>t;t++)s=this.options[this.items[t]][this.settings.labelField]||"",n.push('<option value="'+p(this.items[t])+'" selected="selected">'+p(s)+"</option>");n.length||this.$input.attr("multiple")||n.push('<option value="" selected="selected"></option>'),this.$input.html(n.join(""))}else this.$input.val(this.getValue()),this.$input.attr("value",this.$input.val());this.isSetup&&(e.silent||this.trigger("change",this.$input.val()))},updatePlaceholder:function(){if(this.settings.placeholder){var e=this.$control_input;this.items.length?e.removeAttr("placeholder"):e.attr("placeholder",this.settings.placeholder),e.triggerHandler("update",{force:!0})}},open:function(){this.isLocked||this.isOpen||"multi"===this.settings.mode&&this.isFull()||(this.focus(),this.isOpen=!0,this.refreshState(),this.$dropdown.css({visibility:"hidden",display:"block"}),this.positionDropdown(),this.$dropdown.css({visibility:"visible"}),this.trigger("dropdown_open",this.$dropdown))},close:function(){var e=this.isOpen;"single"===this.settings.mode&&this.items.length&&this.hideInput(),this.isOpen=!1,this.$dropdown.hide(),this.setActiveOption(null),this.refreshState(),e&&this.trigger("dropdown_close",this.$dropdown)},positionDropdown:function(){var e=this.$control,t="body"===this.settings.dropdownParent?e.offset():e.position();t.top+=e.outerHeight(!0),this.$dropdown.css({width:e.outerWidth(),top:t.top,left:t.left})},clear:function(e){this.items.length&&(this.$control.children(":not(input)").remove(),this.items=[],this.lastQuery=null,this.setCaret(0),this.setActiveItem(null),this.updatePlaceholder(),this.updateOriginalInput({silent:e}),this.refreshState(),this.showInput(),this.trigger("clear"))},insertAtCaret:function(t){var i=Math.min(this.caretPos,this.items.length);0===i?this.$control.prepend(t):e(this.$control[0].childNodes[i]).before(t),this.setCaret(i+1)},deleteSelection:function(t){var i,n,s,o,a,r,l,c,d;if(s=t&&8===t.keyCode?-1:1,o=f(this.$control_input[0]),this.$activeOption&&!this.settings.hideSelected&&(l=this.getAdjacentOption(this.$activeOption,-1).attr("data-value")),a=[],this.$activeItems.length){for(d=this.$control.children(".active:"+(s>0?"last":"first")),r=this.$control.children(":not(input)").index(d),s>0&&r++,i=0,n=this.$activeItems.length;n>i;i++)a.push(e(this.$activeItems[i]).attr("data-value"));t&&(t.preventDefault(),t.stopPropagation())}else(this.isFocused||"single"===this.settings.mode)&&this.items.length&&(0>s&&0===o.start&&0===o.length?a.push(this.items[this.caretPos-1]):s>0&&o.start===this.$control_input.val().length&&a.push(this.items[this.caretPos]));if(!a.length||"function"==typeof this.settings.onDelete&&!1===this.settings.onDelete.apply(this,[a]))return!1;for(void 0!==r&&this.setCaret(r);a.length;)this.removeItem(a.pop());return this.showInput(),this.positionDropdown(),this.refreshOptions(!0),l&&(c=this.getOption(l),c.length&&this.setActiveOption(c)),!0},advanceSelection:function(e,t){var i,n,s,o,a,r;0!==e&&(this.rtl&&(e*=-1),i=e>0?"last":"first",n=f(this.$control_input[0]),this.isFocused&&!this.isInputHidden?(o=this.$control_input.val().length,a=0>e?0===n.start&&0===n.length:n.start===o,a&&!o&&this.advanceCaret(e,t)):(r=this.$control.children(".active:"+i),r.length&&(s=this.$control.children(":not(input)").index(r),this.setActiveItem(null),this.setCaret(e>0?s+1:s))))},advanceCaret:function(e,t){var i,n;0!==e&&(i=e>0?"next":"prev",this.isShiftDown?(n=this.$control_input[i](),n.length&&(this.hideInput(),this.setActiveItem(n),t&&t.preventDefault())):this.setCaret(this.caretPos+e))},setCaret:function(t){if(t="single"===this.settings.mode?this.items.length:Math.max(0,Math.min(this.items.length,t)),!this.isPending){var i,n,s,o;for(i=0,n=(s=this.$control.children(":not(input)")).length;n>i;i++)o=e(s[i]).detach(),t>i?this.$control_input.before(o):this.$control.append(o)}this.caretPos=t},lock:function(){this.close(),this.isLocked=!0,this.refreshState()},unlock:function(){this.isLocked=!1,this.refreshState()},disable:function(){this.$input.prop("disabled",!0),this.$control_input.prop("disabled",!0).prop("tabindex",-1),this.isDisabled=!0,this.lock()},enable:function(){this.$input.prop("disabled",!1),this.$control_input.prop("disabled",!1).prop("tabindex",this.tabIndex),this.isDisabled=!1,this.unlock()},destroy:function(){var t=this.eventNS,i=this.revertSettings;this.trigger("destroy"),this.off(),this.$wrapper.remove(),this.$dropdown.remove(),this.$input.html("").append(i.$children).removeAttr("tabindex").removeClass("selectized").attr({tabindex:i.tabindex}).show(),this.$control_input.removeData("grow"),this.$input.removeData("selectize"),e(window).off(t),e(document).off(t),e(document.body).off(t),delete this.$input[0].selectize},render:function(e,t){var i,n,s="",o=!1,a=/^[\t \r\n]*<([a-z][a-z0-9\-_]*(?:\:[a-z][a-z0-9\-_]*)?)/i;return("option"===e||"item"===e)&&(i=d(t[this.settings.valueField]),o=!!i),o&&(c(this.renderCache[e])||(this.renderCache[e]={}),this.renderCache[e].hasOwnProperty(i))?this.renderCache[e][i]:(s=this.settings.render[e].apply(this,[t,p]),("option"===e||"option_create"===e)&&(s=s.replace(a,"<$1 data-selectable")),"optgroup"===e&&(n=t[this.settings.optgroupValueField]||"",s=s.replace(a,'<$1 data-group="'+u(p(n))+'"')),("option"===e||"item"===e)&&(s=s.replace(a,'<$1 data-value="'+u(p(i||""))+'"')),o&&(this.renderCache[e][i]=s),s)},clearCache:function(e){void 0===e?this.renderCache={}:delete this.renderCache[e]},canCreate:function(e){if(!this.settings.create)return!1;var t=this.settings.createFilter;return!(!e.length||"function"==typeof t&&!t.apply(this,[e])||"string"==typeof t&&!new RegExp(t).test(e)||t instanceof RegExp&&!t.test(e))}}),m.count=0,m.defaults={options:[],optgroups:[],plugins:[],delimiter:",",splitOn:null,persist:!0,diacritics:!0,create:!1,createOnBlur:!1,createFilter:null,highlight:!0,openOnFocus:!0,maxOptions:1e3,maxItems:null,hideSelected:null,addPrecedence:!1,selectOnTab:!1,preload:!1,allowEmptyOption:!1,closeAfterSelect:!1,scrollDuration:60,loadThrottle:300,loadingClass:"loading",dataAttr:"data-data",optgroupField:"optgroup",valueField:"value",labelField:"text",optgroupLabelField:"label",optgroupValueField:"value",lockOptgroupOrder:!1,sortField:"$order",searchField:["text"],searchConjunction:"and",mode:null,wrapperClass:"selectize-control",inputClass:"selectize-input",dropdownClass:"selectize-dropdown",dropdownContentClass:"selectize-dropdown-content",dropdownParent:null,copyClassesToDropdown:!0,render:{}},e.fn.selectize=function(t){var i=e.fn.selectize.defaults,n=e.extend({},i,t),s=n.dataAttr,o=n.labelField,a=n.valueField,r=n.optgroupField,l=n.optgroupLabelField,c=n.optgroupValueField;return this.each(function(){if(!this.selectize){var p=e(this),u=this.tagName.toLowerCase(),h=p.attr("placeholder")||p.attr("data-placeholder");h||n.allowEmptyOption||(h=p.children('option[value=""]').text());var v={placeholder:h,options:[],optgroups:[],items:[]};"select"===u?function(t,i){var p,u,h,v,f=i.options,g={},m=function(e){var t=s&&e.attr(s);return"string"==typeof t&&t.length?JSON.parse(t):null},w=function(t,s){t=e(t);var l=d(t.attr("value"));if(l||n.allowEmptyOption)if(g.hasOwnProperty(l)){if(s){var c=g[l][r];c?e.isArray(c)?c.push(s):g[l][r]=[c,s]:g[l][r]=s}}else{var p=m(t)||{};p[o]=p[o]||t.text(),p[a]=p[a]||l,p[r]=p[r]||s,g[l]=p,f.push(p),t.is(":selected")&&i.items.push(l)}},y=function(t){var n,s,o,a,r;for((o=(t=e(t)).attr("label"))&&(a=m(t)||{},a[l]=o,a[c]=o,i.optgroups.push(a)),n=0,s=(r=e("option",t)).length;s>n;n++)w(r[n],o)};for(i.maxItems=t.attr("multiple")?null:1,p=0,u=(v=t.children()).length;u>p;p++)h=v[p].tagName.toLowerCase(),"optgroup"===h?y(v[p]):"option"===h&&w(v[p])}(p,v):function(t,i){var r,l,c,d,p=t.attr(s);if(p)for(i.options=JSON.parse(p),r=0,l=i.options.length;l>r;r++)i.items.push(i.options[r][a]);else{var u=e.trim(t.val()||"");if(!n.allowEmptyOption&&!u.length)return;for(r=0,l=(c=u.split(n.delimiter)).length;l>r;r++)d={},d[o]=c[r],d[a]=c[r],i.options.push(d);i.items=c}}(p,v),new m(p,e.extend(!0,{},i,v,t))}})},e.fn.selectize.defaults=m.defaults,e.fn.selectize.support={validity:l},m.define("drag_drop",function(){if(!e.fn.sortable)throw new Error('The "drag_drop" plugin requires jQuery UI "sortable".');if("multi"===this.settings.mode){var t=this;t.lock=function(){var e=t.lock;return function(){var i=t.$control.data("sortable");return i&&i.disable(),e.apply(t,arguments)}}(),t.unlock=function(){var e=t.unlock;return function(){var i=t.$control.data("sortable");return i&&i.enable(),e.apply(t,arguments)}}(),t.setup=function(){var i=t.setup;return function(){i.apply(this,arguments);var n=t.$control.sortable({items:"[data-value]",forcePlaceholderSize:!0,disabled:t.isLocked,start:function(e,t){t.placeholder.css("width",t.helper.css("width")),n.css({overflow:"visible"})},stop:function(){n.css({overflow:"hidden"});var i=t.$activeItems?t.$activeItems.slice():null,s=[];n.children("[data-value]").each(function(){s.push(e(this).attr("data-value"))}),t.setValue(s),t.setActiveItem(i)}})}}()}}),m.define("dropdown_header",function(t){var i=this;t=e.extend({title:"Untitled",headerClass:"selectize-dropdown-header",titleRowClass:"selectize-dropdown-header-title",labelClass:"selectize-dropdown-header-label",closeClass:"selectize-dropdown-header-close",html:function(e){return'<div class="'+e.headerClass+'"><div class="'+e.titleRowClass+'"><span class="'+e.labelClass+'">'+e.title+'</span><a href="javascript:void(0)" class="'+e.closeClass+'">&times;</a></div></div>'}},t),i.setup=function(){var n=i.setup;return function(){n.apply(i,arguments),i.$dropdown_header=e(t.html(t)),i.$dropdown.prepend(i.$dropdown_header)}}()}),m.define("optgroup_columns",function(t){var i=this;t=e.extend({equalizeWidth:!0,equalizeHeight:!0},t),this.getAdjacentOption=function(t,i){var n=t.closest("[data-group]").find("[data-selectable]"),s=n.index(t)+i;return s>=0&&s<n.length?n.eq(s):e()},this.onKeyDown=function(){var e=i.onKeyDown;return function(t){var n,s,o,a;return!this.isOpen||37!==t.keyCode&&39!==t.keyCode?e.apply(this,arguments):(i.ignoreHover=!0,n=(a=this.$activeOption.closest("[data-group]")).find("[data-selectable]").index(this.$activeOption),void((s=(o=(a=37===t.keyCode?a.prev("[data-group]"):a.next("[data-group]")).find("[data-selectable]")).eq(Math.min(o.length-1,n))).length&&this.setActiveOption(s)))}}();var n=function(){var e,t=n.width,i=document;return void 0===t&&(e=i.createElement("div"),e.innerHTML='<div style="width:50px;height:50px;position:absolute;left:-50px;top:-50px;overflow:auto;"><div style="width:1px;height:100px;"></div></div>',e=e.firstChild,i.body.appendChild(e),t=n.width=e.offsetWidth-e.clientWidth,i.body.removeChild(e)),t},s=function(){var s,o,a,r,l,c,d;if((o=(d=e("[data-group]",i.$dropdown_content)).length)&&i.$dropdown_content.width()){if(t.equalizeHeight){for(a=0,s=0;o>s;s++)a=Math.max(a,d.eq(s).height());d.css({height:a})}t.equalizeWidth&&(c=i.$dropdown_content.innerWidth()-n(),r=Math.round(c/o),d.css({width:r}),o>1&&(l=c-r*(o-1),d.eq(o-1).css({width:l})))}};(t.equalizeHeight||t.equalizeWidth)&&(h.after(this,"positionDropdown",s),h.after(this,"refreshOptions",s))}),m.define("remove_button",function(t){if("single"!==this.settings.mode){var i=this,n='<a href="javascript:void(0)" class="'+(t=e.extend({label:"&times;",title:"Remove",className:"remove",append:!0},t)).className+'" tabindex="-1" title="'+p(t.title)+'">'+t.label+"</a>";this.setup=function(){var s=i.setup;return function(){if(t.append){var o=i.settings.render.item;i.settings.render.item=function(){return function(e,t){var i=e.search(/(<\/[^>]+>\s*)$/);return e.substring(0,i)+t+e.substring(i)}(o.apply(this,arguments),n)}}s.apply(this,arguments),this.$control.on("click","."+t.className,function(t){if(t.preventDefault(),!i.isLocked){var n=e(t.currentTarget).parent();i.setActiveItem(n),i.deleteSelection()&&i.setCaret(i.items.length)}})}}()}}),m.define("restore_on_backspace",function(e){var t=this;e.text=e.text||function(e){return e[this.settings.labelField]},this.onKeyDown=function(){var i=t.onKeyDown;return function(t){var n,s;return 8===t.keyCode&&""===this.$control_input.val()&&!this.$activeItems.length&&(n=this.caretPos-1,n>=0&&n<this.items.length)?(s=this.options[this.items[n]],this.deleteSelection(t)&&(this.setTextboxValue(e.text.apply(this,[s])),this.refreshOptions(!0)),void t.preventDefault()):i.apply(this,arguments)}}()}),m}),function(e,t){e(document).on("ev-repeatable-sortable-stop",function(t,i){var n=e(".wp-editor-area",i).first(),s=n.attr("id"),o=n.parents(".wp-editor-wrap").first(),a=n.clone();a.removeClass("wp-editor-area"),a.removeAttr("aria-hidden"),a.removeAttr("style"),o.replaceWith(a),tinymce.remove("#"+s),a.wp_editor({})}),e.fn.wp_editor=function(t){e(this);if(e(this).is("textarea")||console.warn("Element must be a textarea"),"undefined"!=typeof tinyMCEPreInit&&"undefined"!=typeof QTags&&"undefined"!=typeof ap_vars||console.warn("js_wp_editor( $settings ); must be loaded"),!e(this).is("textarea")||"undefined"==typeof tinyMCEPreInit||"undefined"==typeof QTags||"undefined"==typeof ap_vars)return this;var i={mode:"tmce",mceInit:{theme:"modern",skin:"lightgray",language:"en",formats:{alignleft:[{selector:"p,h1,h2,h3,h4,h5,h6,td,th,div,ul,ol,li",styles:{textAlign:"left"},deep:!1,remove:"none"},{selector:"img,table,dl.wp-caption",classes:["alignleft"],deep:!1,remove:"none"}],aligncenter:[{selector:"p,h1,h2,h3,h4,h5,h6,td,th,div,ul,ol,li",styles:{textAlign:"center"},deep:!1,remove:"none"},{selector:"img,table,dl.wp-caption",classes:["aligncenter"],deep:!1,remove:"none"}],alignright:[{selector:"p,h1,h2,h3,h4,h5,h6,td,th,div,ul,ol,li",styles:{textAlign:"right"},deep:!1,remove:"none"},{selector:"img,table,dl.wp-caption",classes:["alignright"],deep:!1,remove:"none"}],strikethrough:{inline:"del",deep:!0,split:!0}},relative_urls:!1,remove_script_host:!1,convert_urls:!1,browser_spellcheck:!0,fix_list_elements:!0,entities:"38,amp,60,lt,62,gt",entity_encoding:"raw",keep_styles:!1,paste_webkit_styles:"font-weight font-style color",preview_styles:"font-family font-size font-weight font-style text-decoration text-transform",wpeditimage_disable_captions:!1,wpeditimage_html5_captions:!1,plugins:"charmap,hr,media,paste,tabfocus,textcolor,fullscreen,wordpress,wpeditimage,wpgallery,wplink,wpdialogs,wpview,image",content_css:ap_vars.includes_url+"css/dashicons.css?ver=3.9,"+ap_vars.includes_url+"js/mediaelement/mediaelementplayer.min.css?ver=3.9,"+ap_vars.includes_url+"js/mediaelement/wp-mediaelement.css?ver=3.9,"+ap_vars.includes_url+"js/tinymce/skins/wordpress/wp-content.css?ver=3.9",selector:"#apid",resize:"vertical",menubar:!1,wpautop:!0,indent:!1,toolbar1:"bold,italic,strikethrough,bullist,numlist,blockquote,hr,alignleft,aligncenter,alignright,link,unlink,wp_more,spellchecker,fullscreen,wp_adv",toolbar2:"formatselect,underline,alignjustify,forecolor,pastetext,removeformat,charmap,outdent,indent,undo,redo,wp_help",toolbar3:"",toolbar4:"",tabfocus_elements:":prev,:next",body_class:"apid"}},n=new RegExp("apid","g");tinyMCEPreInit.mceInit.apid&&(i.mceInit=tinyMCEPreInit.mceInit.apid);t=e.extend(!0,i,t);return void 0===switchEditors.evswitchto&&(switchEditors.evswitchto=function(e){var t=e.id,i=t.length,n=t.substr(0,i-5),s=t.substr(i-4);return this.go(n,s),!1}),this.each(function(){if(e(this).is("textarea")){var i=e(this).attr("id");e.each(t.mceInit,function(s,o){"string"==e.type(o)&&(t.mceInit[s]=o.replace(n,i))}),t.mode="tmce"==t.mode?"tmce":"html";var s=e.extend({},t.mceInit,{selector:"#"+i});tinyMCEPreInit.mceInit[i]=s,e(this).addClass("wp-editor-area").show();var o=this;if(e(this).closest(".wp-editor-wrap").length){var a=e(this).closest(".wp-editor-wrap").parent();e(this).closest(".wp-editor-wrap").before(e(this).clone()),e(this).closest(".wp-editor-wrap").remove(),o=a.find('textarea[id="'+i+'"]')}var r=e('<div id="wp-'+i+'-wrap" class="wp-core-ui wp-editor-wrap '+t.mode+'-active" />'),l=e('<div id="wp-'+i+'-editor-tools" class="wp-editor-tools hide-if-no-js" />'),c=e('<div class="wp-editor-tabs" />'),d=e('<a id="'+i+'-html" class="ev-switch-editor switch-html" onclick="switchEditors.evswitchto(this);">'+ev_framework.editor.text+"</a>"),p=e('<a id="'+i+'-tmce" class="ev-switch-editor switch-tmce" onclick="switchEditors.evswitchto(this);">'+ev_framework.editor.visual+"</a>"),u=e('<div id="wp-'+i+'-media-buttons" class="wp-media-buttons" />'),h=e('<a href="#" id="insert-media-button" class="button insert-media add_media" data-editor="'+i+'" title="'+ev_framework.editor.add_media+'"><span class="wp-media-buttons-icon"></span> '+ev_framework.editor.add_media+"</a>"),v=e('<div id="wp-'+i+'-editor-container" class="wp-editor-container" />');ap_vars.upload_files&&(h.appendTo(u),u.appendTo(l)),p.appendTo(c),d.appendTo(c),c.appendTo(l),l.appendTo(r),v.appendTo(r),v.append(e(o).clone().addClass("wp-editor-area")),e(o).before(r),e(o).remove(),new QTags(i),QTags._buttonsInit(),switchEditors.go(i,t.mode),e(r).on("click",".insert-media",function(t){var i=e(t.currentTarget),n=i.data("editor"),s={frame:"post",state:"insert",title:wp.media.view.l10n.addMedia,multiple:!0};t.preventDefault(),i.blur(),i.hasClass("gallery")&&(s.state="gallery",s.title=wp.media.view.l10n.createGalleryTitle),wp.media.editor.open(n,s)})}else console.warn("Element must be a textarea")})}}(jQuery,window),function(e){var t={vertical:{x:!1,y:!0},horizontal:{x:!0,y:!1},both:{x:!0,y:!0},x:{x:!0,y:!1},y:{x:!1,y:!0}},i={duration:"fast",direction:"both",easing:"linear",offset:0},n=/^(?:html)$/i,s=function(t){var i=e(window),s=n.test(t[0].nodeName);return{border:s?{top:0,left:0,bottom:0,right:0}:function(t,i){i=i||(document.defaultView&&document.defaultView.getComputedStyle?document.defaultView.getComputedStyle(t,null):t.currentStyle);var n=!(!document.defaultView||!document.defaultView.getComputedStyle),s={top:parseFloat(n?i.borderTopWidth:e.css(t,"borderTopWidth"))||0,left:parseFloat(n?i.borderLeftWidth:e.css(t,"borderLeftWidth"))||0,bottom:parseFloat(n?i.borderBottomWidth:e.css(t,"borderBottomWidth"))||0,right:parseFloat(n?i.borderRightWidth:e.css(t,"borderRightWidth"))||0};return{top:s.top,left:s.left,bottom:s.bottom,right:s.right,vertical:s.top+s.bottom,horizontal:s.left+s.right}}(t[0]),scroll:{top:(s?i:t).scrollTop(),left:(s?i:t).scrollLeft()},scrollbar:{right:s?0:t.innerWidth()-t[0].clientWidth,bottom:s?0:t.innerHeight()-t[0].clientHeight},rect:function(){var e=t[0].getBoundingClientRect();return{top:s?0:e.top,left:s?0:e.left,bottom:s?t[0].clientHeight:e.bottom,right:s?t[0].clientWidth:e.right}}()}};e.fn.extend({scrollintoview:function(o){(o=e.extend({},i,o)).direction=t["string"==typeof o.direction&&o.direction.toLowerCase()]||t.both;var a="";!0===o.direction.x&&(a="horizontal"),!0===o.direction.y&&(a=a?"both":"vertical");var r=this.eq(0),l=r.closest(":scrollable("+a+")");if(l.length>0){l=l.eq(0);var c=s(r),d=s(l),p={top:c.rect.top-(d.rect.top+d.border.top),bottom:d.rect.bottom-d.border.bottom-d.scrollbar.bottom-c.rect.bottom,left:c.rect.left-(d.rect.left+d.border.left),right:d.rect.right-d.border.right-d.scrollbar.right-c.rect.right},u={};!0===o.direction.y&&(p.top<0?u.scrollTop=d.scroll.top+p.top:p.top>0&&p.bottom<0&&(u.scrollTop=d.scroll.top+Math.min(p.top,-p.bottom)),u.scrollTop+=parseInt(o.offset,10)),!0===o.direction.x&&(p.left<0?u.scrollLeft=d.scroll.left+p.left:p.left>0&&p.right<0&&(u.scrollLeft=d.scroll.left+Math.min(p.left,-p.right)),u.scrollLeft+=parseInt(o.offset,10)),e.isEmptyObject(u)?e.isFunction(o.complete)&&o.complete.call(l[0]):(n.test(l[0].nodeName)&&(l=e("html,body")),l.animate(u,o.duration,o.easing).eq(0).queue(function(t){e.isFunction(o.complete)&&o.complete.call(l[0]),t()}))}return this}});var o={auto:!0,scroll:!0,visible:!1,hidden:!1};e.extend(e.expr[":"],{scrollable:function(e,i,s,a){var r=t["string"==typeof s[3]&&s[3].toLowerCase()]||t.both,l=document.defaultView&&document.defaultView.getComputedStyle?document.defaultView.getComputedStyle(e,null):e.currentStyle,c={x:o[l.overflowX.toLowerCase()]||!1,y:o[l.overflowY.toLowerCase()]||!1,isRoot:n.test(e.nodeName)};if(!c.x&&!c.y&&!c.isRoot)return!1;var d={height:{scroll:e.scrollHeight,client:e.clientHeight},width:{scroll:e.scrollWidth,client:e.clientWidth},scrollableX:function(){return(c.x||c.isRoot)&&this.width.scroll>this.width.client},scrollableY:function(){return(c.y||c.isRoot)&&this.height.scroll>this.height.client}};return r.y&&d.scrollableY()||r.x&&d.scrollableX()}})}(jQuery),function(e){e.evf.history={},e.evf.history.push=function(e){history&&history.pushState&&history.pushState(null,null,e)},e.evf.history.pushQueryString=function(t,i){t=e(t);var n="",s=window.location.toString();if(t.attr("href")&&0===t.attr("href").indexOf("#")?n=t.attr("href"):t.attr("data-target")&&0===t.attr("data-target").indexOf("#")&&(n=t.attr("data-target")),""!==(n=n.replace("#",""))){if(""===window.location.search)s+="?"+i+"="+n;else{var o=window.location.search.substring(1),a=e.deparam(o);a[i]=n,s=s.replace(o,e.param(a))}e.evf.history.push(s)}},e.evf.history.pushHash=function(t){var i="";(t=e(t)).attr("href")&&0===t.attr("href").indexOf("#")?i=t.attr("href"):t.attr("data-target")&&0===t.attr("data-target").indexOf("#")&&(i=t.attr("data-target")),""!==i&&e.evf.history.push(i)}}(jQuery),function(e){var t="ev-tooltip-container",i=16;window.ev_tooltip_destroy=function(t){var i=e("body").get(0).style;if("transition"in i||"WebkitTransition"in i||"MozTransition"in i||"msTransition"in i||"OTransition"in i){e(this).on("transitionend.ev webkitTransitionEnd.ev oTransitionEnd.ev MSTransitionEnd.ev",function(e){t.remove()})}else t.remove();t.removeClass("ev-tooltip-active")},window.ev_seek_and_destroy_tooltips=function(){e("."+t).remove()};function n(t,n,s){var o=t.outerHeight(),a=t.outerWidth(),r=n.outerHeight()+i/2,l=n.outerWidth(),c={},d=t.offset().top,p=d-e(window).scrollTop();e("body").is(".admin-bar")&&(p-=e("#wpadminbar").outerHeight()),c.left=t.offset().left-l/2+a/2,n.removeClass("ev-tooltip-expand-top ev-tooltip-expand-bottom ev-tooltip-expand-left ev-tooltip-expand-right ev-tooltip-vertical ev-tooltip-horizontal");var u=s&&"vertical"!=s?"ev-tooltip-horizontal":"ev-tooltip-vertical";r<=p?(d+=2,n.addClass("ev-tooltip-expand-top"),c.top=d-r):(d-=2,n.addClass("ev-tooltip-expand-bottom"),c.top=d+o+i/2),n.addClass(u).css(c)}window.ev_create_tooltip=function(i,s,o){var a=e(i);if(!(void 0!==s&&s||void 0!==(s=a.attr("data-title")||a.attr("title"))&&""!==s))return!1;o=e.extend(!0,{},{class:"",mode:"horizontal"},o),ev_seek_and_destroy_tooltips();var r=t+" "+o.class,l=e('<div class="'+r+'"></div>').appendTo("body");return a.data("ev-tooltip",l),l.html(s).css({top:0,left:0}),e(window).on("resize scroll",function(){n(a,l,o.mode)}),n(a,l,o.mode),l.show(),l.addClass("ev-tooltip-active"),l},e.evf.delegate(".ev-tooltip","mouseover","tooltip",function(){ev_create_tooltip(e(this))}),e.evf.delegate(".ev-tooltip","mouseout click","tooltip",function(){var t=e(this).data("ev-tooltip");t&&window.ev_tooltip_destroy(t)}),e.evf.delegate(".ev-tooltip-container","click","tooltip",function(){window.ev_tooltip_destroy(e(this))})}(jQuery),function(e){window.Ev_MediaSelector=function(t){window.ev_ms_obj=this,window.ev_ms_obj.options=e.extend({},{title:void 0,multiple:!1,type:"",button:void 0,close:function(){},select:function(e){}},t),window.ev_ms_obj.frame=null,window.ev_ms_obj.open=function(e){var t=wp.media.controller.Library.extend({defaults:_.defaults({id:"ev-media-selector",title:window.ev_ms_obj.options.title,allowLocalEdits:!1,displaySettings:!1,displayUserSettings:!1,multiple:window.ev_ms_obj.options.multiple,library:wp.media.query({type:window.ev_ms_obj.options.type})},wp.media.controller.Library.prototype.defaults)});window.ev_ms_obj.frame=wp.media({title:window.ev_ms_obj.options.title,button:{text:window.ev_ms_obj.options.button},state:"ev-media-selector",states:[new t]}),window.ev_ms_obj.frame.on("open",function(){var t=window.ev_ms_obj.frame.state("ev-media-selector").get("selection");t.reset(),_.each(e,function(e){var i=wp.media.attachment(e);i.fetch(),t.add(i?[i]:[])})}),window.ev_ms_obj.frame.on("select",function(){var e=window.ev_ms_obj.frame.state("ev-media-selector").get("selection"),t=window.ev_ms_obj.options.multiple?e.toJSON():e.first().toJSON();window.ev_ms_obj.options.select(t)}),window.ev_ms_obj.frame.on("close",function(){window.ev_ms_obj.options.close()}),window.ev_ms_obj.frame.open()}}}(jQuery),function(e){e.evf.ui.add(".ev-sortable .ev-container-repeatable-inner-wrapper",function(){var t=null,i=function(){t=null,e("#wpbody").css("padding-bottom","")};e(document).off("mousedown.ev_sortable").off("mouseup.ev_sortable"),e(document).on("mousedown.ev_sortable",".ev-sortable-handle",function(){!function(i){if(null!==t)return!1;var n=0;n=e(i).parents(".ev-bundle-fields-wrapper").length?e(i).parents(".ev-bundle-fields-wrapper").first():e(i).parents(".ev-field-inner").first(),t=n.outerHeight(),e.evSaveRichTextareas(n),e("#wpbody").css("padding-bottom",t+10)}(e(this))}),e(document).on("mouseup.ev_sortable",".ev-sortable-handle",function(){i()}),e(this).sortable({handle:".ev-sortable-handle",items:"> .ev-field-inner, .ev-bundle-fields-wrapper",tolerance:"pointer",distance:10,start:function(n,s){var o={height:t};e(".ui-sortable-placeholder").css(o),i()},stop:function(t,i){var n=e(i.item).parents(".ev-sortable").first(),s=e("> .ev-field-inner, .ev-bundle-fields-wrapper",n),o=e(i.item).parents(".ev-repeatable").length;s.each(function(t,i){e("[name]",i).each(function(){var i=e(this).attr("name"),n=new RegExp(/\[\d+\]/g),s=i.match(n),a=0;if(s&&s.length){for(var r=0;r<s.length;r++)s[r]=r===o-1?"["+t+"]":s[r];for(var l=null;null!==(l=n.exec(i));)c=i,d=l.index,p=s[a],u=s[a].length,i=c.substr(0,d)+p+c.substr(d+u),a++;e(this).attr("name",i)}var c,d,p,u})}),e(document).trigger("ev-repeatable-sortable-stop",[e(i.item)])}})}),e.evf.delegate(".ev-repeatable-remove","click","repeatable",function(){if(e(this).parents(".ev-attachment-placeholder").length)return!1;var t=e(this).parents(".ev-field").first(),i=e(".ev-container, .ev-bundle-fields-wrapper",t).first();return e(this).parents(".ev-field-inner, .ev-bundle-fields-wrapper").first().remove(),e(".ev-field-inner",i).length||t.addClass("ev-no-fields"),!1}),e.evf.delegate(".ev-repeat-remove-all","click","repeatable",function(){var t=e(this).parents(".ev-field").first(),i=e(".ev-container",t).first();return e(".ev-field-inner, .ev-bundle-fields-wrapper",i).remove(),t.addClass("ev-no-fields"),!1}),e.evf.delegate(".ev-field.ev-repeatable .ev-repeat","click","repeatable",function(){var t=e(this),i=t.parents(".ev-field.ev-repeatable").first(),n=t.parents(".ev-field-inner, .ev-bundle-fields-wrapper").first(),s=t.parents(".ev-container-repeatable-inner-wrapper").first(),o=e(".ev-empty-state",i),a=o.attr("data-key"),r=e("script[type='text/template'][data-template='"+a+"']"),l=t.attr("data-mode"),c=function(t,a){!function(){var e=parseInt(o.attr("data-count"),10);e+=1,o.attr("data-count",e)}();a?"append"===a?t.insertAfter(n):"prepend"===a&&t.insertBefore(n):t.appendTo(s),e(".ev-field-inner",i).each(function(){e(".ev-repeatable-controls",this).first();var t=parseInt(o.attr("data-count"),10);e("[name]",d).each(function(){e(this).attr("name",this.name.replaceLast("[]","["+t+"]"))})});i.removeClass("ev-no-fields"),setTimeout(function(){e.evf.ui.build(),function(t){var i=(t=e(t).get(0)).getBoundingClientRect();i.top>=0&&i.left>=0&&i.bottom<=(window.innerHeight||document.documentElement.clientHeight)&&i.right<=(window.innerWidth||document.documentElement.clientWidth)||e(t).scrollintoview({duration:300,direction:"vertical",offset:40})}(t)},1)};if(t.attr("data-action"))window[t.attr("data-action")](r,c);else{var d=e(e.evf.template(r,{}));c(d,l)}return!1})}(jQuery),function(e){e.evf.delegate(".ev-close-persistent-message","click","messages",function(){return e(this).parents(".ev-persistent-message").first().remove(),!1}),window.ev_save_options_tab_button=function(e,t){return!1},window.ev_save_options_tab=function(t){e.evSaveRichTextareas(t);var i=e("form",t).first(),n=e(".ev-btn-type-save[data-callback]",i).first(),s=i.serialize().replace(/%5B%5D/g,"[]"),o=e("#ev").val();return s+="&action="+n.attr("data-callback"),s+="&nonce="+o,ev_idle_button(n),e.post(i.attr("action"),s,function(e){ev_unidle_button(n,e)},"json"),!1},e.evf.on(".ev-admin-page .ev-tab > form","submit","save-options-tab",function(){var t=e(this).parents(".ev-tab").first();return window.ev_save_options_tab(t),!1})}(jQuery),function(e){e.evf.ui.add(".ev-image-upload[data-multiple][data-sortable] .ev-image-placeholder-container",function(){e(this).sortable({items:"> .ev-image-placeholder",update:function(t,i){var n=e(t.target).parents(".ev-image-upload").first(),s=e("input[data-id]",n),o=[];e(".ev-image-placeholder",n).each(function(){o.push(e("img[data-id]",e(this)).attr("data-id"))}),s.val(o.join(","))}})}),e.evf.delegate(".ev-image-upload .ev-upload-remove","click","image_upload",function(){var t=e(this).parents(".ev-image-upload").first(),i=e(".ev-image-placeholder-container",t),n=void 0!==t.attr("data-multiple"),s=e("input[data-id]",t);if(n){e(this).parents(".ev-image-placeholder").first().remove();var o=e(".ev-image-placeholder",t);if(o.length){var a=[];o.each(function(){a.push(e("img[data-id]",e(this)).attr("data-id"))}),s.val(a.join(","))}else{t.removeClass("ev-image-uploaded"),s.val("");var r=e("script[type='text/template'][data-template='ev-image-placeholder']");i.append(e.evf.template(r,{url:"",id:""}))}}else s.val(""),e("img",t).attr("src",""),t.removeClass("ev-image-uploaded");return!1}),e.evf.delegate(".ev-image-upload .ev-remove-all-action","click","image_upload",function(){var t=e(this).parents(".ev-image-upload").first(),i=e(".ev-image-placeholder",t),n=e("input[data-id]",t);return i.remove(),t.removeClass("ev-image-uploaded"),n.val(""),!1}),e.evf.delegate(".ev-image-upload .ev-edit-action, .ev-image-upload .ev-upload-action","click","image_upload",function(){var t=e(this).parents(".ev-image-upload").first(),i=e(".ev-image-placeholder-container",t),n=t.attr("data-thumb-size"),s=void 0!==t.attr("data-multiple"),o=e("input[data-id]",t).val();return new window.Ev_MediaSelector({type:"image",multiple:s,select:function(o){var a=e("script[type='text/template'][data-template='ev-image-placeholder']"),r="";if(i.html(""),s)r=_.pluck(o,"id").join(","),e.each(o,function(){var t="";this.sizes&&this.sizes.full&&(t=this.sizes.full.url),this.sizes&&this.sizes[n]&&(t=this.sizes[n].url),i.append(e.evf.template(a,{url:t,id:this.id}))});else{var l="";r=o.id,l=o.sizes&&o.sizes.full?o.sizes.full.url:o.url,o.sizes&&o.sizes[n]&&(l=o.sizes[n].url),i.append(e.evf.template(a,{url:l,id:r}))}t.addClass("ev-image-uploaded"),e("input[data-id]",t).val(r)}}).open(o.split(",")),!1})}(jQuery),function(e){e.evf.ui.add(".ev-attachment-upload-container[data-multiple][data-sortable]",function(){e(this).sortable({items:"> .ev-attachment-placeholder",update:function(t,i){var n=e(t.target),s=e("input[data-id]",n),o=[];e(".ev-attachment-placeholder",n).each(function(){o.push(e("[data-id]",e(this)).attr("data-id"))}),s.val(o.join(","))}})}),e.evf.delegate(".ev-attachment-placeholder .ev-upload-remove","click","attachment_upload",function(){var t=e(this).parents(".ev-attachment-placeholder").first(),i=e(this).parents(".ev-attachment-upload-container").first(),n=void 0!==i.attr("data-multiple"),s=e("input[data-id]",i);if(t.remove(),n){var o=e(".ev-attachment-placeholder",i);if(o.length){var a=[];o.each(function(){a.push(e("[data-id]",e(this)).attr("data-id"))}),s.val(a.join(","))}else i.removeClass("ev-attachment-uploaded"),s.val("")}else s.val(""),e("img",i).attr("src",""),i.removeClass("ev-attachment-uploaded");return!1}),e.evf.delegate(".ev-attachment-upload-container .ev-remove-all-action","click","attachment_upload",function(){var t=e(this).parents(".ev-attachment-upload-container").first(),i=e(".ev-attachment-placeholder",t),n=e("input[data-id]",t);return i.remove(),t.removeClass("ev-attachment-uploaded"),n.val(""),!1}),e.evf.delegate(".ev-attachment-upload-container .ev-edit-action, .ev-attachment-upload-container .ev-upload-action","click","attachment_upload",function(){var t=e(this).parents(".ev-attachment-upload-container").first(),i=t.attr("data-type"),n=(t.attr("data-thumb-size"),void 0!==t.attr("data-multiple")),s=e("input[data-id]",t).val();return new window.Ev_MediaSelector({type:i,multiple:n,select:function(i){var s="",o=e(".ev-attachment-upload-action",t),a=e("script[type='text/template'][data-template='ev-attachment-placeholder']");if(e(".ev-attachment-placeholder",t).remove(),n)s=_.pluck(i,"id").join(","),e.each(i,function(){var t=this.url.split(/[\\/]/).pop()+" ("+this.filesizeHumanReadable+")",i=this.type;this.subtype&&(i+="-"+this.subtype),o.before(e.evf.template(a,{type:i,id:this.id,title:this.title,extension:t,url:this.url}))});else{s=i.id;var r=i.url.split(/[\\/]/).pop()+" ("+i.filesizeHumanReadable+")",l=i.type;i.subtype&&(l+="-"+i.subtype),o.before(e.evf.template(a,{type:l,id:s,title:i.title,extension:r,url:i.url}))}t.addClass("ev-attachment-uploaded"),e("input[data-id]",t).val(s)}}).open(s.split(",")),!1})}(jQuery),function(e){e.evf.ui.add("select.ev-multiple-select-input-ajax",function(){e(this).each(function(){var t=e(this).attr("data-action"),i=e(this).attr("data-value-field"),n=e(this).attr("data-label-field"),s=e(this).attr("data-search-field"),o=e(this).attr("data-nonce"),a=e(this).attr("data-max")?parseInt(e(this).attr("data-max"),10):1e3,r=e(this).attr("data-create")?parseInt(e(this).attr("data-create"),10):0;e(this).selectize({plugins:["remove_button","drag_drop"],valueField:i,labelField:n,searchField:[s],dropdownParent:"body",create:r,maxItems:a,onDropdownOpen:function(t){e(t).addClass("ev-multiple-select")},load:function(i,n){if(!i.length)return n();e.ajax({url:ajaxurl,type:"POST",data:{action:t,search:i,nonce:o},error:function(){n()},success:function(t){n(e.parseJSON(t))}})},render:{item:function(e,t){var i="<div>";return e.spec&&""!==e.spec&&(i+="<span>"+t(e.spec)+"</span>"),i+=t(e.text),i+="</div>"},option:function(e,t){var i="<div>";return e.spec&&""!==e.spec&&(i+="<span>"+t(e.spec)+"</span>"),i+=t(e.text),i+="</div>"}}})})}),e.evf.ui.add("input.ev-multiple-select-input",function(){e(this).each(function(){var t=e.parseJSON(e(this).attr("data-options")),i=e(this).attr("data-max")?parseInt(e(this).attr("data-max"),10):t.length+1;e(this).selectize({plugins:["remove_button","drag_drop"],options:t,valueField:"val",labelField:"label",searchField:["label"],dropdownParent:"body",maxItems:i,create:!1,onDropdownOpen:function(t){e(t).addClass("ev-multiple-select")},render:{item:function(e,t){var i="<div>";return e.spec&&""!==e.spec&&(i+="<span>"+t(e.spec)+"</span>"),i+=t(e.label),i+="</div>"},option:function(e,t){var i="<div>";return e.spec&&""!==e.spec&&(i+="<span>"+t(e.spec)+"</span>"),i+=t(e.label),i+="</div>"}}})})})}(jQuery),function(e){e.evf.delegate(".ev-color-preset","click","color",function(){var t=e(this).parents(".ev-color-presets-manager-wrapper").first(),i=e("[data-hex-value-input]",t);return e(this).hasClass("ev-selected")?(e(this).removeClass("ev-selected"),i.val("")):(e(".ev-selected",t).removeClass("ev-selected"),e(this).addClass("ev-selected"),i.val(e(this).attr("data-hex"))),!1}),e.evf.delegate("[data-color-delete-preset]","click","color",function(){var t=e(this),i=e(this).parents(".ev-color-preset").first(),n=i.attr("data-id"),s=e(this).parents(".ev-color-user-presets").first(),o=e(this).parents(".ev-color-presets-wrapper").first();return n&&(i.remove(),window.ev_seek_and_destroy_tooltips(),e(".ev-color-preset",o).length||e("body").removeClass("ev-has-color-presets"),e(".ev-color-preset",s).length?s.addClass("ev-color-has-user-presets"):s.removeClass("ev-color-has-user-presets"),ev_framework.color.presets=_.without(ev_framework.color.presets,_.findWhere(ev_framework.color.presets,{user:!0,id:n})),e.post(ajaxurl,{action:"ev_color_delete_preset",nonce:t.attr("data-nonce"),id:n},function(e){})),!1}),e.evf.delegate("[data-color-save-preset]","click","color",function(){var t=e(this),i=t.parents(".ev-color-wrapper").first(),n=e(".ev-color-input",i).val();if(n){var s=prompt(ev_framework.color.new_preset_name);if(!s)return!1;ev_idle_button(t),e.post(ajaxurl,{action:"ev_color_save_preset",nonce:t.attr("data-nonce"),hex:n,name:s,id:ev_framework.color.presets.length+1},function(i){ev_framework.color.presets.user||(ev_framework.color.presets.user=[]),ev_framework.color.presets.user.push({user:!0,hex:n,label:s}),e("body").addClass("ev-has-color-presets"),ev_unidle_button(t)})}return!1}),e.evf.delegate("[data-color-presets]","click","color",function(){var t=e(this),i=t.parents(".ev-color-wrapper").first(),n=e(".ev-color-input",i),s=n.attr("data-opacity"),o=e("[data-input-color-opacity]",i),a={hex:n.val()};return new e.evf.modal("ev-color-presets",a,{simple:!0,save:function(e,t,i){e.hex&&(s&&(-1===e.hex.indexOf("#")?o.val((r=(r=(r=(r=(r=e.hex).replace("rgba(","")).replace(")","")).replace(" ","")).split(","))[r.length-1]):o.val("1"),n.attr("data-opacity",o.val())),s||-1===e.hex.indexOf("rgba(")||(e.hex=(a=e.hex,(a=a.match(/^rgba?[\s+]?\([\s+]?(\d+)[\s+]?,[\s+]?(\d+)[\s+]?,[\s+]?(\d+)[\s+]?/i))&&4===a.length?"#"+("0"+parseInt(a[1],10).toString(16)).slice(-2)+("0"+parseInt(a[2],10).toString(16)).slice(-2)+("0"+parseInt(a[3],10).toString(16)).slice(-2):"")),n.val(e.hex).trigger("keyup"));var a,r}}).open(function(i,n,s){var o={action:"ev_color_presets_modal_load",nonce:t.attr("data-nonce"),data:s},a=".ev-modal-container[data-key='"+n+"']";e(a+" .ev-modal-wrapper").addClass("ev-loading"),e.post(ajaxurl,o,function(t){t=e(t),e(a+" .ev-modal-wrapper").removeClass("ev-loading"),i.html(t),setTimeout(function(){e.evf.ui.build()},1)})}),!1}),e.evf.ui.add("input.ev-color-input",function(){e(this).each(function(){var t=e(this),i=t.parents(".ev-color-wrapper").first(),n=t.attr("data-opacity"),s={control:"wheel",change:function(s,o){t.css("border-color",s),void 0!==n&&e("[data-input-color-opacity]",i).val(o),""!==s?i.addClass("ev-color-can-be-saved"):i.removeClass("ev-color-can-be-saved")}};void 0!==n&&(s.opacity=!0,s.format="rgb"),e(this).minicolors(s).trigger("change")})})}(jQuery),function(e){window.evf_ui_rich_textareas=0,e.evf.ui.add("textarea.ev-rich",function(){e(this).each(function(){window.evf_ui_rich_textareas++;var t=e(this).attr("id");t=(t=t.replace(/\[/g,"_")).replace(/\]/g,"_"),e(this).attr("id",t+"-"+window.evf_ui_rich_textareas),e(this).wp_editor()})})}(jQuery),function(e){e.evf.delegate(".ev-selected-icon-wrapper","click","icon",function(){var t=e(this),i=t.parents(".ev-field").first(),n=e(".ev-selected-icon-wrapper",i),s={prefix:e("[data-prefix]",i).val(),set:e("[data-set]",i).val(),icon:e("[data-icon]",i).val(),color:e("[data-color]",i).val(),size:e("[data-size]",i).val()};return new e.evf.modal("ev-icon",s,{simple:!0,save:function(t,s,o){e("[data-prefix]",i).val(t.prefix),e("[data-set]",i).val(t.set),e("[data-icon]",i).val(t.icon),e("[data-color]",i).val(t.color.color),e("[data-size]",i).val(t.size),e("[data-preview]",i).attr("class","").css("color",""),e("[data-preview]",i).attr("class","ev-icon ev-component "+t.prefix+" "+t.icon).css("color",t.color.color),t.icon?n.removeClass("ev-empty"):n.addClass("ev-empty")}}).open(function(i,n,s){var o={action:"ev_icon_modal_load",data:s,nonce:t.attr("data-nonce")},a=".ev-modal-container[data-key='"+n+"']";e(a+" .ev-modal-wrapper").addClass("ev-loading"),e.post(ajaxurl,o,function(t){t=e(t),e(a+" .ev-modal-wrapper").removeClass("ev-loading"),i.html(t),e("[data-icon-search]",i).focus(),setTimeout(function(){e.evf.ui.build()},1)})}),!1}),e.evf.delegate(".ev-icon-remove","click","icon",function(){var t=e(this).parents(".ev-field").first();return e(".ev-selected-icon-wrapper",t).addClass("ev-empty"),e("[data-prefix]",t).val(""),e("[data-set]",t).val(""),e("[data-icon]",t).val(""),e("[data-color]",t).val(""),e("[data-size]",t).val(""),e("[data-preview]",t).attr("class","ev-icon ev-component").css("color",""),!1}),e.evf.delegate("input[data-icon-search]","keydown","icon",function(e){if(13==e.which)return!1}),e.evf.delegate("input[data-icon-search]","keyup","icon",function(){var t=e(this).parents(".ev-icon-sets-external-wrapper").first(),i=e(this).val(),n=e(".ev-icon",t);if(""!=i?e(".ev-icon-sets",t).addClass("ev-searching"):e(".ev-icon-sets",t).removeClass("ev-searching"),n.removeClass("ev-found"),n=n.filter('[data-icon-stripped*="'+i+'"]').addClass("ev-found"),e(".ev-icon-search-results",t).addClass("ev-search-icon-results-visible"),n.length){var s=n.length>1?2:1;e(".ev-icon-search-results",t).html(ev_icon_field[s].replace("%s",n.length))}else""!=i?e(".ev-icon-search-results",t).html(ev_icon_field[0]):e(".ev-icon-search-results",t).removeClass("ev-search-icon-results-visible")}),e.evf.delegate(".ev-icon-sets i","click","icon",function(){var t=e(this),i=e(this).parents(".ev-icon-sets-external-wrapper").first(),n=e(".ev-icon",i),s=e("[name='color[color]']",i).val(),o=e("[data-icon-size]",i).val(),a=e(".ev-selected-icon-preview",i);n.removeClass("ev-found ev-selected"),t.addClass("ev-selected"),e(".ev-icon-sets",i).removeClass("ev-searching"),e("[data-icon-prefix]",i).val(t.attr("data-prefix")),e("[data-icon-set]",i).val(t.attr("data-set")),e("[data-icon-name]",i).val(t.attr("data-icon-name")),a.removeAttr("class").attr("class","ev-selected-icon-preview ev-icon ev-component "+t.attr("data-prefix")+" "+t.attr("data-icon-name")).css({color:s,"font-size":o}),e("input[data-icon-search]",i).val(""),e(".ev-icon-search-results",i).html("").removeClass("ev-search-icon-results-visible")}),e.evf.delegate(".ev-icon-sets-controls-field-wrapper [name='color[color]']","change","icon",function(){var t=e(this).parents(".ev-icon-sets-external-wrapper").first();e(".ev-selected-icon-preview",t).css({color:e(this).val()})}),e.evf.delegate(".ev-icon-sets-controls-field-wrapper [name='size']","input","icon",function(){var t=e(this).parents(".ev-icon-sets-external-wrapper").first();e(".ev-selected-icon-preview",t).css({"font-size":e(this).val()})})}(jQuery),function(e){e.evf.delegate(".ev-help-popup .ev-help-handle","click","field",function(){var t=e(".ev-help-popup-text",this).html();return new e.evf.modal("ev-help-popup",{},{simple:!0}).open(function(e,i,n){e.html(t)}),!1});function t(t){switch(t.attr("data-type")){case"radio":return e("input[type='radio'][name]:checked",t).first();case"select":return e("select[name]",t).first();case"checkbox":return e("input[type='checkbox'][name]",t).first()}return!1}function i(i){var n=i.parents(".ev-tab-container").first();i.parents(".ev-field-bundle").length&&(n=i.parents(".ev-field-bundle").first());var s=i.attr("data-slave"),o=e("[data-controller='"+s+"']",n),a=t(o);if(a){var r=a.val();a.is("[type='checkbox']")&&(r=a.is(":checked")?"1":"0");var l=i.attr("data-controller-value");if(-1!=l.indexOf(","))-1==(l=l.split(",")).indexOf(r)||o.hasClass("ev-hidden")?(i.addClass("ev-hidden"),e("[data-slave='"+i.attr("data-controller")+"']",n).addClass("ev-hidden")):(i.removeClass("ev-hidden"),e("[data-slave='"+i.attr("data-controller")+"']",n).removeClass("ev-hidden"));else{var c=!0;if(-1!==l.indexOf("!="))c=(l=l.replace("!=",""))==r;else if(0===l.indexOf("count")){var d=l.charAt(5),p=l.split(d),u=!1;if(isNaN(p)){var h=""+l,v=parseInt(h.match(/\d+/)[0],10);u=(u=(u=h.replace(v,"")).replace("count","")).replace(d,""),p=v}else p=parseInt(p[1],10);if(-1!==r.indexOf(d))if(u)switch(u){case">":c=r.split(d).length<=p;break;case"<":c=r.split(d).length>=p}else c=r.split(d).length!=p;else c=!0}else c=l!=r;c||o.hasClass("ev-hidden")?(i.addClass("ev-hidden"),e("[data-slave='"+i.attr("data-controller")+"']",n).addClass("ev-hidden")):(i.removeClass("ev-hidden"),e("[data-slave='"+i.attr("data-controller")+"']",n).removeClass("ev-hidden"))}i.is("[data-controller]")&&t(i).trigger("change")}}e.evf.ui.add("[data-slave]",function(){e(this).each(function(){i(e(this))})}),e.evf.delegate("[data-controller] :input","change","field",function(){var n=e(this).parents(".ev-field").first();if(e(this).is(t(n))){var s=n.parents(".ev-tab-container").first();n.parents(".ev-field-bundle").length&&(s=n.parents(".ev-field-bundle").first());e(this).val();var o=e(this).parents("[data-controller]").first().attr("data-controller"),a=e("[data-slave='"+o+"']",s);a.each(function(){i(e(this))});var r=a.not(".ev-hidden").last(),l=e(this).parents(".ev-tabs").first();if(r.length&&l.length&&l.css("overflow-y")){var c=r.position().top+2*r.outerHeight();l.get(0).scrollTop=c}}})}(jQuery),function(e){e(document).on("input.ev_link",".ev-link-input-wrapper input",function(){""!==e(this).val()?e(this).parent().addClass("ev-not-empty"):e(this).parent().removeClass("ev-not-empty")}),e.evf.delegate(".ev-link-ctrl-btn","click","link",function(){var t=e(this),i=e(this).parents(".ev-link-ctrl").first(),n={url:e("[data-link-url]",i).val(),target:e("[data-link-target]",i).val(),rel:e("[data-link-rel]",i).val(),title:e("[data-link-title]",i).val(),class:e("[data-link-class]",i).val()};return new e.evf.modal("ev-link",n,{simple:!0,close:function(){e(window).off("keydown.ev_link")},save:function(n,s,o){e("[data-link-url]",i).val(n.url),e("[data-link-target]",i).val(n.target),e("[data-link-rel]",i).val(n.rel),e("[data-link-title]",i).val(n.title),e("[data-link-class]",i).val(n.class),t.removeClass("ev-link-on"),""!=n.url&&t.addClass("ev-link-on")}}).open(function(t,s,o){var a={action:"ev_link_modal_load",nonce:i.attr("data-nonce"),data:o},r=".ev-modal-container[data-key='"+s+"']";(o.rel||n.title||n.class)&&e(r).addClass("ev-link-modal-expanded"),e(r+" .ev-modal-wrapper").addClass("ev-loading"),e(window).off("keydown.ev_link"),e(window).on("keydown.ev_link",function(t){if(9==t.which)return e('.ev-modal-container[data-key="ev-link"]').addClass("ev-link-modal-expanded"),e(window).off("keydown.ev_link"),!1}),e.post(ajaxurl,a,function(i){i=e(i),e(r+" .ev-modal-wrapper").removeClass("ev-loading"),t.html(i),setTimeout(function(){e.evf.ui.build()},1)})}),!1});e.evf.ui.add(".ev-link-input-wrapper input",function(){e(this).trigger("input.ev_link")}),e.evf.ui.add(".ev-link-url-wrapper [name='url']",function(){var t=e(this).attr("data-nonce");e(this).selectize({plugins:[],valueField:"id",labelField:"text",searchField:["text"],dropdownParent:"body",create:!0,createOnBlur:!0,maxItems:1,onDropdownOpen:function(t){e(t).addClass("ev-multiple-select")},load:function(i,n){if(!i.length||(s=i,/(ftp|http|https):\/\/(\w+:{0,1}\w*@)?(\S+)(:[0-9]+)?(\/|\/([\w#!:.?+=&%@!\-\/]))?/.test(s)))return n();var s;e.ajax({url:ajaxurl,type:"POST",data:{action:"ev_link_search_entries",search:i,nonce:t},error:function(){n()},success:function(t){n(e.parseJSON(t))}})},render:{item:function(e,t){var i="<div>";return e.spec&&""!==e.spec&&(i+="<span>"+t(e.spec)+"</span>"),i+=t(e.text),i+="</div>"},option:function(e,t){var i="<div>";return e.spec&&""!==e.spec&&(i+="<span>"+t(e.spec)+"</span>"),i+=t(e.text),i+="</div>"},option_create:function(e,t){return'<div class="ev-link-create create">'+ev_framework.link.create+"</div>"}}}),e(this).get(0).selectize.focus()})}(jQuery),function(e){window.ev_idle_button=function(t){e(t).addClass("ev-btn-idle").attr("disabled","disabled").trigger("start.ev_button")};function t(t,i){var n=!1;e(t).addClass("ev-btn-complete"),i&&(e(t).addClass("ev-btn-"+i.type),n=ev_create_tooltip(t,i.message,{class:"ev-tooltip-response-"+i.type})),setTimeout(function(){e(t).removeAttr("data-title"),e(t).removeClass("ev-btn-complete"),i&&(n&&ev_tooltip_destroy(n),e(t).removeClass("ev-btn-"+i.type))},1500)}window.ev_unidle_button=function(i,n){var s=e("body").get(0).style;if("transition"in s||"WebkitTransition"in s||"MozTransition"in s||"msTransition"in s||"OTransition"in s){var o="transitionend.ev webkitTransitionEnd.ev oTransitionEnd.ev MSTransitionEnd.ev";e(i).on(o,function(s){e(i).off(o),t(i,n)})}else t(i,n);e(i).removeClass("ev-btn-idle").removeAttr("disabled").trigger("done.ev_button")}}(jQuery),function(e){e.evf.ui.add(".ev-date-input",function(){e(this).each(function(){e(this).datepicker({dateFormat:e(this).attr("data-format"),dayNamesShort:ev_date_field.dayNamesShort,dayNames:ev_date_field.dayNames,monthNamesShort:ev_date_field.monthNamesShort,monthNames:ev_date_field.monthNames,prevText:ev_date_field.prevText,nextText:ev_date_field.nextText,showAnim:""})})})}(jQuery);